2025-06-26 13:13:53,848 - __main__ - INFO - Starting GTFS-RT processor...
2025-06-26 13:13:53,915 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-06-26 13:13:53,915 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:13:53,920 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-06-26 13:13:53,921 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:13:53,925 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-06-26 13:13:53,925 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:13:53,929 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 13:13:53,929 - __main__ - INFO - Creating database tables if they don't exist...
2025-06-26 13:13:53,932 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = $1::VARCHAR AND pg_catalog.pg_class.relkind = ANY (ARRAY[$2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != $7::VARCHAR
2025-06-26 13:13:53,933 - sqlalchemy.engine.Engine - INFO - [generated in 0.00109s] ('live_vehicle_positions', 'r', 'p', 'f', 'v', 'm', 'pg_catalog')
2025-06-26 13:13:53,942 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-26 13:13:53,944 - __main__ - INFO - Starting data fetch cycle...
2025-06-26 13:13:53,944 - __main__ - INFO - Fetching vehicle positions from https://realtime.goldengate.org/gtfsrealtime/VehiclePositions
2025-06-26 13:13:54,184 - __main__ - INFO - Processing 25 vehicle positions
2025-06-26 13:13:54,185 - __main__ - INFO - Processing 25 vehicle positions
2025-06-26 13:13:54,186 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 13:13:54,189 - sqlalchemy.engine.Engine - INFO - SELECT live_vehicle_positions.vehicle_id 
FROM live_vehicle_positions
2025-06-26 13:13:54,190 - sqlalchemy.engine.Engine - INFO - [generated in 0.00106s] ()
2025-06-26 13:13:54,200 - __main__ - INFO - Processed 25 vehicle positions: 25 new, 0 updated, 0 errors
2025-06-26 13:13:54,201 - __main__ - INFO - Fetching trip updates from https://realtime.goldengate.org/gtfsrealtime/TripUpdates
2025-06-26 13:13:54,347 - __main__ - INFO - Processing 45 trip updates
2025-06-26 13:13:54,348 - __main__ - INFO - Processing 45 trip updates
2025-06-26 13:13:54,350 - __main__ - INFO - Processed 45 trip updates with 0 errors
2025-06-26 13:13:54,356 - sqlalchemy.engine.Engine - INFO - INSERT INTO live_vehicle_positions (vehicle_id, trip_id, route_id, latitude, longitude, bearing, speed, current_status, congestion_level, occupancy_status, stop_id, timestamp) SELECT p0::VARCHAR, p1::VARCHAR, p2::VARCHAR, p3::FLOAT, p4::FLOAT, p5::FL ... 5013 characters truncated ... ounter) ORDER BY sen_counter RETURNING live_vehicle_positions.id, live_vehicle_positions.id AS id__1
2025-06-26 13:13:54,357 - sqlalchemy.engine.Engine - INFO - [generated in 0.00028s (insertmanyvalues) 1/1 (ordered)] ('961', '9236905', '101', 38.471466064453125, -122.74051666259766, None, None, 1, None, 1, None, datetime.datetime(2025, 6, 26, 20, 13, 46), '1914', '9236953', '150', 37.78746795654297, -122.42169952392578, None, None, 2, None, 1, None, datetime.datetime(2025, 6, 26, 20, 13, 45), '2401', '9236694', '23', 37.97636795043945, -122.56189727783203, None, None, 2, None, 0, None, datetime.datetime(2025, 6, 26, 20, 13, 38), '1934', '9236769', '130', 37.77931594848633, -122.41504669189453, None, None, 2, None, 1, None, datetime.datetime(2025, 6, 26, 20, 13, 40), '1923', '9236894' ... 200 parameters truncated ... None, datetime.datetime(2025, 6, 26, 20, 13, 47), '2010', '9236844', '71', 37.92413330078125, -122.51384735107422, None, None, 2, None, 0, None, datetime.datetime(2025, 6, 26, 20, 13, 41), '2009', '9236573', '35', 37.965885162353516, -122.50578308105469, None, None, 1, None, 0, None, datetime.datetime(2025, 6, 26, 20, 13, 39), '1952', '9236751', '130', 37.872318267822266, -122.51158142089844, None, None, 1, None, 1, None, datetime.datetime(2025, 6, 26, 20, 13, 49), '1906', '9236969', '150', 37.80876541137695, -122.47716522216797, None, None, 2, None, 1, None, datetime.datetime(2025, 6, 26, 20, 13, 42))
2025-06-26 13:13:54,365 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-26 13:13:54,371 - __main__ - ERROR - Error in main processing loop: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $8: 1 (expected str, got int)
[SQL: INSERT INTO live_vehicle_positions (vehicle_id, trip_id, route_id, latitude, longitude, bearing, speed, current_status, congestion_level, occupancy_status, stop_id, timestamp) SELECT p0::VARCHAR, p1::VARCHAR, p2::VARCHAR, p3::FLOAT, p4::FLOAT, p5::FL ... 5013 characters truncated ... ounter) ORDER BY sen_counter RETURNING live_vehicle_positions.id, live_vehicle_positions.id AS id__1]
[parameters: ('961', '9236905', '101', 38.471466064453125, -122.74051666259766, None, None, 1, None, 1, None, datetime.datetime(2025, 6, 26, 20, 13, 46), '1914', '9236953', '150', 37.78746795654297, -122.42169952392578, None, None, 2, None, 1, None, datetime.datetime(2025, 6, 26, 20, 13, 45), '2401', '9236694', '23', 37.97636795043945, -122.56189727783203, None, None, 2, None, 0, None, datetime.datetime(2025, 6, 26, 20, 13, 38), '1934', '9236769', '130', 37.77931594848633, -122.41504669189453, None, None, 2, None, 1, None, datetime.datetime(2025, 6, 26, 20, 13, 40), '1923', '9236894' ... 200 parameters truncated ... None, datetime.datetime(2025, 6, 26, 20, 13, 47), '2010', '9236844', '71', 37.92413330078125, -122.51384735107422, None, None, 2, None, 0, None, datetime.datetime(2025, 6, 26, 20, 13, 41), '2009', '9236573', '35', 37.965885162353516, -122.50578308105469, None, None, 1, None, 0, None, datetime.datetime(2025, 6, 26, 20, 13, 39), '1952', '9236751', '130', 37.872318267822266, -122.51158142089844, None, None, 1, None, 1, None, datetime.datetime(2025, 6, 26, 20, 13, 49), '1906', '9236969', '150', 37.80876541137695, -122.47716522216797, None, None, 2, None, 1, None, datetime.datetime(2025, 6, 26, 20, 13, 42))]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
Traceback (most recent call last):
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 175, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
  File "asyncpg\\protocol\\codecs/base.pyx", line 227, in asyncpg.protocol.protocol.Codec.encode
  File "asyncpg\\protocol\\codecs/base.pyx", line 129, in asyncpg.protocol.protocol.Codec.encode_scalar
  File "asyncpg\\pgproto\\./codecs/text.pyx", line 29, in asyncpg.pgproto.pgproto.text_encode
  File "asyncpg\\pgproto\\./codecs/text.pyx", line 12, in asyncpg.pgproto.pgproto.as_pg_string_and_size
TypeError: expected str, got int

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 545, in _prepare_and_execute
    self._rows = deque(await prepared_stmt.fetch(*parameters))
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 176, in fetch
    data = await self.__bind_execute(args, 0, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 267, in __bind_execute
    data, status, _ = await self.__do_execute(
                      ^^^^^^^^^^^^^^^^^^^^^^^^
        lambda protocol: protocol.bind_execute(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            self._state, args, '', limit, True, timeout))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\asyncpg\prepared_stmt.py", line 256, in __do_execute
    return await executor(protocol)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg\\protocol\\protocol.pyx", line 185, in bind_execute
  File "asyncpg\\protocol\\prepared_stmt.pyx", line 204, in asyncpg.protocol.protocol.PreparedStatementState._encode_bind_msg
asyncpg.exceptions.DataError: invalid input for query argument $8: 1 (expected str, got int)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2114, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $8: 1 (expected str, got int)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 302, in main
    await session.commit()
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 1014, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 2032, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4345, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4480, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\orm\session.py", line 4441, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 93, in save_obj
    _emit_insert_statements(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper,
        ^^^^^^^^^^^^
    ...<3 lines>...
        insert,
        ^^^^^^^
    )
    ^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\orm\persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 1840, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2122, in _exec_insertmany_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e,
        ^^
    ...<4 lines>...
        is_sub_exec=True,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2114, in _exec_insertmany_context
    dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~^
        cursor,
        ^^^^^^^
    ...<2 lines>...
        context,
        ^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\.venv\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.DataError'>: invalid input for query argument $8: 1 (expected str, got int)
[SQL: INSERT INTO live_vehicle_positions (vehicle_id, trip_id, route_id, latitude, longitude, bearing, speed, current_status, congestion_level, occupancy_status, stop_id, timestamp) SELECT p0::VARCHAR, p1::VARCHAR, p2::VARCHAR, p3::FLOAT, p4::FLOAT, p5::FL ... 5013 characters truncated ... ounter) ORDER BY sen_counter RETURNING live_vehicle_positions.id, live_vehicle_positions.id AS id__1]
[parameters: ('961', '9236905', '101', 38.471466064453125, -122.74051666259766, None, None, 1, None, 1, None, datetime.datetime(2025, 6, 26, 20, 13, 46), '1914', '9236953', '150', 37.78746795654297, -122.42169952392578, None, None, 2, None, 1, None, datetime.datetime(2025, 6, 26, 20, 13, 45), '2401', '9236694', '23', 37.97636795043945, -122.56189727783203, None, None, 2, None, 0, None, datetime.datetime(2025, 6, 26, 20, 13, 38), '1934', '9236769', '130', 37.77931594848633, -122.41504669189453, None, None, 2, None, 1, None, datetime.datetime(2025, 6, 26, 20, 13, 40), '1923', '9236894' ... 200 parameters truncated ... None, datetime.datetime(2025, 6, 26, 20, 13, 47), '2010', '9236844', '71', 37.92413330078125, -122.51384735107422, None, None, 2, None, 0, None, datetime.datetime(2025, 6, 26, 20, 13, 41), '2009', '9236573', '35', 37.965885162353516, -122.50578308105469, None, None, 1, None, 0, None, datetime.datetime(2025, 6, 26, 20, 13, 39), '1952', '9236751', '130', 37.872318267822266, -122.51158142089844, None, None, 1, None, 1, None, datetime.datetime(2025, 6, 26, 20, 13, 49), '1906', '9236969', '150', 37.80876541137695, -122.47716522216797, None, None, 2, None, 1, None, datetime.datetime(2025, 6, 26, 20, 13, 42))]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-06-26 13:14:04,425 - __main__ - INFO - Starting data fetch cycle...
2025-06-26 13:14:04,430 - __main__ - INFO - Fetching vehicle positions from https://realtime.goldengate.org/gtfsrealtime/VehiclePositions
2025-06-26 13:14:14,450 - __main__ - ERROR - Network error fetching GTFS-RT feed from https://realtime.goldengate.org/gtfsrealtime/VehiclePositions: <urlopen error timed out>
2025-06-26 13:14:14,451 - __main__ - INFO - Fetching trip updates from https://realtime.goldengate.org/gtfsrealtime/TripUpdates
2025-06-26 13:14:24,466 - __main__ - ERROR - Network error fetching GTFS-RT feed from https://realtime.goldengate.org/gtfsrealtime/TripUpdates: <urlopen error timed out>
2025-06-26 13:14:24,467 - __main__ - INFO - Successfully committed changes to database
2025-06-26 13:14:24,467 - __main__ - INFO - Sleeping for 30 seconds before next update...
2025-06-26 13:16:02,397 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-06-26 13:16:02,398 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:16:02,405 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-06-26 13:16:02,406 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:16:02,410 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-06-26 13:16:02,410 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:16:02,415 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 13:16:02,416 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-26 13:16:02,435 - __main__ - INFO - Database URL: postgresql+asyncpg://user:mysecretpassword@localhost:5432/transitpulse_db
2025-06-26 13:16:13,591 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-06-26 13:16:13,592 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:16:13,597 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-06-26 13:16:13,598 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:16:13,605 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-06-26 13:16:13,605 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:16:13,611 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 13:16:13,612 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-26 13:16:13,627 - __main__ - INFO - Database URL: postgresql+asyncpg://user:mysecretpassword@localhost:5432/transitpulse_db
2025-06-26 13:16:52,747 - __main__ - INFO - 🚀 Starting GTFS-RT processor...
2025-06-26 13:16:52,748 - __main__ - INFO - 🔌 Testing database connection...
2025-06-26 13:16:52,856 - __main__ - ERROR - ❌ Database connection failed: name 'text' is not defined
2025-06-26 13:16:52,857 - __main__ - ERROR - ❌ Database connection test failed. Please check your database configuration and make sure it's running.
2025-06-26 13:16:52,858 - __main__ - INFO - Database URL: postgresql+asyncpg://user:mysecretpassword@localhost:5432/transitpulse_db
2025-06-26 13:16:52,859 - __main__ - INFO - 💡 Make sure PostgreSQL is running and accessible with the provided credentials.
2025-06-26 13:17:28,740 - __main__ - INFO - 🚀 Starting GTFS-RT processor...
2025-06-26 13:17:28,741 - __main__ - INFO - 🔌 Testing database connection...
2025-06-26 13:17:28,815 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-06-26 13:17:28,816 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:17:28,822 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-06-26 13:17:28,823 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:17:28,829 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-06-26 13:17:28,829 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:17:28,836 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 13:17:28,836 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-26 13:17:28,837 - __main__ - ERROR - ❌ Database connection failed: name 'text' is not defined
2025-06-26 13:17:28,838 - __main__ - ERROR - ❌ Database connection test failed. Please check your database configuration and make sure it's running.
2025-06-26 13:17:28,838 - __main__ - INFO - Database URL: postgresql+asyncpg://user:mysecretpassword@localhost:5432/transitpulse_db
2025-06-26 13:17:28,838 - __main__ - INFO - 💡 Make sure PostgreSQL is running and accessible with the provided credentials.
2025-06-26 13:18:13,135 - __main__ - INFO - Starting GTFS-RT processor...
2025-06-26 13:18:13,135 - __main__ - INFO - Testing database connection...
2025-06-26 13:18:13,228 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-06-26 13:18:13,229 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:18:13,234 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-06-26 13:18:13,235 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:18:13,248 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-06-26 13:18:13,249 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:18:13,261 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 13:18:13,263 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-26 13:18:13,265 - __main__ - ERROR - ❌ Database connection failed: name 'text' is not defined
2025-06-26 13:18:13,266 - __main__ - ERROR - Database connection test failed. Please check your database configuration and make sure it's running.
2025-06-26 13:18:13,267 - __main__ - INFO - Database URL: postgresql+asyncpg://user:mysecretpassword@localhost:5432/transitpulse_db
2025-06-26 13:18:13,268 - __main__ - INFO - Make sure PostgreSQL is running and accessible with the provided credentials.
2025-06-26 13:19:23,992 - __main__ - INFO - Starting GTFS-RT processor...
2025-06-26 13:19:23,992 - __main__ - INFO - Testing database connection...
2025-06-26 13:19:24,122 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-06-26 13:19:24,123 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:19:24,128 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-06-26 13:19:24,129 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:19:24,136 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-06-26 13:19:24,136 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:19:24,142 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 13:19:24,143 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-26 13:19:24,144 - __main__ - ERROR - Database operations failed: name 'text' is not defined
Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 281, in test_database_connection
    result = await conn.execute(text("SELECT 1"))
                                ^^^^
NameError: name 'text' is not defined. Did you mean: 'next'?
2025-06-26 13:19:24,151 - __main__ - ERROR - Database connection test failed. Please check your database configuration and make sure it's running.
2025-06-26 13:19:24,151 - __main__ - INFO - Database URL: postgresql+asyncpg://user:mysecretpassword@localhost:5432/transitpulse_db
2025-06-26 13:19:24,152 - __main__ - INFO - Make sure PostgreSQL is running and accessible with the provided credentials.
2025-06-26 13:20:09,940 - __main__ - INFO - Starting GTFS-RT processor...
2025-06-26 13:20:09,941 - __main__ - INFO - Testing database connection...
2025-06-26 13:20:10,235 - asyncio - WARNING - Executing <Task pending name='Task-1' coro=<main() running at C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py:333> wait_for=<Future pending cb=[_chain_future.<locals>._call_check_cancel() at C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\asyncio\futures.py:384, Task.task_wakeup()] created at C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py:459> cb=[_run_until_complete_cb() at C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\asyncio\base_events.py:181] created at C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\asyncio\runners.py:100> took 0.295 seconds
2025-06-26 13:20:10,438 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-06-26 13:20:10,438 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:20:10,483 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-06-26 13:20:10,484 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:20:10,498 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-06-26 13:20:10,499 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:20:10,509 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 13:20:10,511 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-26 13:20:10,514 - __main__ - ERROR - Database operations failed: name 'text' is not defined
Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 281, in test_database_connection
    result = await conn.execute(text("SELECT 1"))
                                ^^^^
NameError: name 'text' is not defined. Did you mean: 'next'?
2025-06-26 13:20:10,522 - __main__ - ERROR - Database connection test failed. Please check your database configuration and make sure it's running.
2025-06-26 13:20:10,522 - __main__ - INFO - Database URL: postgresql+asyncpg://user:mysecretpassword@localhost:5432/transitpulse_db
2025-06-26 13:20:10,523 - __main__ - INFO - Make sure PostgreSQL is running and accessible with the provided credentials.
2025-06-26 13:22:08,272 - __main__ - INFO - Starting GTFS-RT processor...
2025-06-26 13:22:08,274 - __main__ - INFO - Testing database connection...
2025-06-26 13:22:08,459 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-06-26 13:22:08,460 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:22:08,478 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-06-26 13:22:08,479 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:22:08,500 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-06-26 13:22:08,501 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:22:08,513 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 13:22:08,514 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-26 13:22:08,518 - __main__ - ERROR - Database operations failed: name 'text' is not defined
Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 281, in test_database_connection
    result = await conn.execute(text("SELECT 1"))
                                ^^^^
NameError: name 'text' is not defined. Did you mean: 'next'?
2025-06-26 13:22:08,526 - __main__ - ERROR - Database connection test failed. Please check your database configuration and make sure it's running.
2025-06-26 13:22:08,527 - __main__ - INFO - Database URL: postgresql+asyncpg://user:mysecretpassword@localhost:5432/transitpulse_db
2025-06-26 13:22:08,527 - __main__ - INFO - Make sure PostgreSQL is running and accessible with the provided credentials.
2025-06-26 13:22:46,468 - __main__ - INFO - Starting GTFS-RT processor...
2025-06-26 13:22:46,469 - __main__ - INFO - Testing database connection...
2025-06-26 13:22:46,598 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-06-26 13:22:46,599 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:22:46,615 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-06-26 13:22:46,616 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:22:46,630 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-06-26 13:22:46,631 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:22:46,642 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 13:22:46,644 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-26 13:22:46,647 - __main__ - ERROR - Database operations failed: name 'text' is not defined
Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 281, in test_database_connection
    result = await conn.execute(text("SELECT 1"))
                                ^^^^
NameError: name 'text' is not defined. Did you mean: 'next'?
2025-06-26 13:22:46,655 - __main__ - ERROR - Database connection test failed. Please check your database configuration and make sure it's running.
2025-06-26 13:22:46,656 - __main__ - INFO - Database URL: postgresql+asyncpg://user:mysecretpassword@localhost:5432/transitpulse_db
2025-06-26 13:22:46,657 - __main__ - INFO - Make sure PostgreSQL is running and accessible with the provided credentials.
2025-06-26 13:22:53,296 - __main__ - INFO - Starting GTFS-RT processor...
2025-06-26 13:22:53,297 - __main__ - INFO - Testing database connection...
2025-06-26 13:22:53,365 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-06-26 13:22:53,366 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:22:53,379 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-06-26 13:22:53,380 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:22:53,392 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-06-26 13:22:53,393 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:22:53,399 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 13:22:53,399 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-26 13:22:53,400 - __main__ - ERROR - Database operations failed: name 'text' is not defined
Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 281, in test_database_connection
    result = await conn.execute(text("SELECT 1"))
                                ^^^^
NameError: name 'text' is not defined. Did you mean: 'next'?
2025-06-26 13:22:53,412 - __main__ - ERROR - Database connection test failed. Please check your database configuration and make sure it's running.
2025-06-26 13:22:53,413 - __main__ - INFO - Database URL: postgresql+asyncpg://user:mysecretpassword@localhost:5432/transitpulse_db
2025-06-26 13:22:53,413 - __main__ - INFO - Make sure PostgreSQL is running and accessible with the provided credentials.
2025-06-26 13:24:50,003 - __main__ - INFO - Starting GTFS-RT processor...
2025-06-26 13:24:50,004 - __main__ - INFO - Testing database connection...
2025-06-26 13:24:50,072 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-06-26 13:24:50,073 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:24:50,077 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-06-26 13:24:50,077 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:24:50,082 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-06-26 13:24:50,082 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:24:50,087 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 13:24:50,088 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-26 13:24:50,090 - __main__ - ERROR - Error during database operations: name 'text' is not defined
Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 281, in test_database_connection
    result = await conn.execute(text("SELECT 1"))
                                ^^^^
NameError: name 'text' is not defined. Did you mean: 'next'?
2025-06-26 13:24:50,097 - __main__ - ERROR - Database connection test failed. Please check your database configuration and make sure it's running.
2025-06-26 13:24:50,097 - __main__ - INFO - Database URL: postgresql+asyncpg://user:mysecretpassword@localhost:5432/transitpulse_db
2025-06-26 13:24:50,098 - __main__ - INFO - Make sure PostgreSQL is running and accessible with the provided credentials.
2025-06-26 13:47:22,356 - __main__ - INFO - Starting GTFS-RT processor...
2025-06-26 13:47:22,358 - __main__ - INFO - Testing database connection...
2025-06-26 13:47:25,122 - __main__ - ERROR - Database connection test failed: [Errno 11002] getaddrinfo failed
2025-06-26 13:47:25,122 - __main__ - INFO - Database URL: postgresql+asyncpg://user:mysecretpassword@db:5432/transitpulse_db
2025-06-26 13:47:25,123 - __main__ - INFO - Make sure PostgreSQL is running and accessible with the provided credentials.
2025-06-26 13:47:25,123 - __main__ - ERROR - GTFS-RT processor stopped due to database connection failure.
2025-06-26 13:47:25,124 - __main__ - INFO - GTFS-RT processor stopped.
2025-06-26 13:52:09,216 - __main__ - INFO - Starting GTFS-RT processor...
2025-06-26 13:52:09,217 - __main__ - INFO - Testing database connection...
2025-06-26 13:52:09,487 - databases - INFO - Connected to database postgresql+asyncpg://user:********@localhost:5432/transitpulse_db
2025-06-26 13:52:09,524 - databases - INFO - Disconnected from database postgresql+asyncpg://user:********@localhost:5432/transitpulse_db
2025-06-26 13:52:09,525 - __main__ - INFO - Database connection test passed!
2025-06-26 13:52:09,525 - __main__ - INFO - Starting continuous GTFS-RT processing loop...
2025-06-26 13:52:09,526 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 13:52:10,185 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 13:52:10,185 - __main__ - ERROR - An unexpected error occurred during GTFS-RT processing for GG: Protocol message VehiclePosition has no "delay" field.
2025-06-26 13:52:10,186 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 110, in fetch_and_process_gtfs_rt_data
    "delay": vehicle.delay if vehicle.HasField('delay') else None,
                              ~~~~~~~~~~~~~~~~^^^^^^^^^
ValueError: Protocol message VehiclePosition has no "delay" field.

2025-06-26 13:52:10,187 - __main__ - WARNING - Error during GTFS-RT fetch. Retrying in 29 seconds...
2025-06-26 13:52:39,532 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 13:52:40,536 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 13:52:40,538 - __main__ - ERROR - An unexpected error occurred during GTFS-RT processing for GG: Protocol message VehiclePosition has no "delay" field.
2025-06-26 13:52:40,539 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 110, in fetch_and_process_gtfs_rt_data
    "delay": vehicle.delay if vehicle.HasField('delay') else None,
                              ~~~~~~~~~~~~~~~~^^^^^^^^^
ValueError: Protocol message VehiclePosition has no "delay" field.

2025-06-26 13:52:40,540 - __main__ - WARNING - Error during GTFS-RT fetch. Retrying in 28 seconds...
2025-06-26 13:53:09,538 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 13:53:10,335 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 13:53:10,337 - __main__ - ERROR - An unexpected error occurred during GTFS-RT processing for GG: Protocol message VehiclePosition has no "delay" field.
2025-06-26 13:53:10,339 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 110, in fetch_and_process_gtfs_rt_data
    "delay": vehicle.delay if vehicle.HasField('delay') else None,
                              ~~~~~~~~~~~~~~~~^^^^^^^^^
ValueError: Protocol message VehiclePosition has no "delay" field.

2025-06-26 13:53:10,340 - __main__ - WARNING - Error during GTFS-RT fetch. Retrying in 29 seconds...
2025-06-26 13:53:39,550 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 13:53:39,950 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 13:53:39,951 - __main__ - ERROR - An unexpected error occurred during GTFS-RT processing for GG: Protocol message VehiclePosition has no "delay" field.
2025-06-26 13:53:39,952 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 110, in fetch_and_process_gtfs_rt_data
    "stop_id": str(vehicle.stop_id) if vehicle.HasField('stop_id') else None,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Protocol message VehiclePosition has no "delay" field.

2025-06-26 13:53:39,952 - __main__ - WARNING - Error during GTFS-RT fetch. Retrying in 29 seconds...
2025-06-26 13:54:09,553 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 13:54:09,874 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 13:54:09,875 - __main__ - ERROR - An unexpected error occurred during GTFS-RT processing for GG: Protocol message VehiclePosition has no "delay" field.
2025-06-26 13:54:09,875 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 110, in fetch_and_process_gtfs_rt_data
    "stop_id": str(vehicle.stop_id) if vehicle.HasField('stop_id') else None,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Protocol message VehiclePosition has no "delay" field.

2025-06-26 13:54:09,876 - __main__ - WARNING - Error during GTFS-RT fetch. Retrying in 29 seconds...
2025-06-26 13:54:39,567 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 13:54:40,104 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 13:54:40,105 - __main__ - ERROR - An unexpected error occurred during GTFS-RT processing for GG: Protocol message VehiclePosition has no "delay" field.
2025-06-26 13:54:40,105 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 110, in fetch_and_process_gtfs_rt_data
    "stop_id": str(vehicle.stop_id) if vehicle.HasField('stop_id') else None,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Protocol message VehiclePosition has no "delay" field.

2025-06-26 13:54:40,106 - __main__ - WARNING - Error during GTFS-RT fetch. Retrying in 29 seconds...
2025-06-26 13:55:09,579 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 13:55:09,874 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 13:55:09,876 - __main__ - ERROR - An unexpected error occurred during GTFS-RT processing for GG: Protocol message VehiclePosition has no "delay" field.
2025-06-26 13:55:09,877 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 110, in fetch_and_process_gtfs_rt_data
    "stop_id": str(vehicle.stop_id) if vehicle.HasField('stop_id') else None,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Protocol message VehiclePosition has no "delay" field.

2025-06-26 13:55:09,878 - __main__ - WARNING - Error during GTFS-RT fetch. Retrying in 29 seconds...
2025-06-26 13:55:39,592 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 13:55:40,252 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 13:55:40,254 - __main__ - ERROR - An unexpected error occurred during GTFS-RT processing for GG: Protocol message VehiclePosition has no "delay" field.
2025-06-26 13:55:40,255 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 110, in fetch_and_process_gtfs_rt_data
    "stop_id": str(vehicle.stop_id) if vehicle.HasField('stop_id') else None,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Protocol message VehiclePosition has no "delay" field.

2025-06-26 13:55:40,256 - __main__ - WARNING - Error during GTFS-RT fetch. Retrying in 29 seconds...
2025-06-26 13:56:09,607 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 13:56:10,358 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 13:56:10,359 - __main__ - ERROR - An unexpected error occurred during GTFS-RT processing for GG: Protocol message VehiclePosition has no "delay" field.
2025-06-26 13:56:10,360 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 110, in fetch_and_process_gtfs_rt_data
    "stop_id": str(vehicle.stop_id) if vehicle.HasField('stop_id') else None,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Protocol message VehiclePosition has no "delay" field.

2025-06-26 13:56:10,361 - __main__ - WARNING - Error during GTFS-RT fetch. Retrying in 29 seconds...
2025-06-26 13:56:39,614 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 13:56:39,935 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 13:56:39,936 - __main__ - ERROR - An unexpected error occurred during GTFS-RT processing for GG: Protocol message VehiclePosition has no "delay" field.
2025-06-26 13:56:39,937 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 110, in fetch_and_process_gtfs_rt_data
    "stop_id": str(vehicle.stop_id) if vehicle.HasField('stop_id') else None,
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Protocol message VehiclePosition has no "delay" field.

2025-06-26 13:56:39,937 - __main__ - WARNING - Error during GTFS-RT fetch. Retrying in 29 seconds...
2025-06-26 13:57:01,455 - __main__ - INFO - GTFS-RT processor stopped by user.
2025-06-26 13:57:01,455 - __main__ - INFO - GTFS-RT processor stopped.
2025-06-26 13:57:25,507 - __main__ - INFO - Starting GTFS-RT processor...
2025-06-26 13:57:25,508 - __main__ - INFO - Testing database connection...
2025-06-26 13:57:25,716 - databases - INFO - Connected to database postgresql+asyncpg://user:********@localhost:5432/transitpulse_db
2025-06-26 13:57:25,729 - databases - INFO - Disconnected from database postgresql+asyncpg://user:********@localhost:5432/transitpulse_db
2025-06-26 13:57:25,729 - __main__ - INFO - Database connection test passed!
2025-06-26 13:57:25,730 - __main__ - INFO - Starting continuous GTFS-RT processing loop...
2025-06-26 13:57:25,730 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 13:57:26,320 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 13:57:26,368 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-06-26 13:57:26,369 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:57:26,373 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-06-26 13:57:26,374 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:57:26,377 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-06-26 13:57:26,378 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:57:26,380 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 13:57:26,383 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR
2025-06-26 13:57:26,384 - sqlalchemy.engine.Engine - INFO - [generated in 0.00114s] (datetime.datetime(2025, 6, 26, 13, 57, 20), '1902', '9236970', '150', 37.87966537475586, -122.51641845703125, None, None, 1, None, 1, None, None, '1902')
2025-06-26 13:57:26,392 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-26 13:57:26,394 - __main__ - ERROR - An unexpected error occurred during GTFS-RT processing for GG: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "delay" of relation "live_vehicle_positions" does not exist
[SQL: UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR]
[parameters: (datetime.datetime(2025, 6, 26, 13, 57, 20), '1902', '9236970', '150', 37.87966537475586, -122.51641845703125, None, None, 1, None, 1, None, None, '1902')]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-26 13:57:26,526 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, self._invalidate_schema_cache_asof
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, name=self._prepared_statement_name_func()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "delay" of relation "live_vehicle_positions" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "delay" of relation "live_vehicle_positions" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 124, in fetch_and_process_gtfs_rt_data
    result = await db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1648, in orm_execute_statement
    return super().orm_execute_statement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        session,
        ^^^^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "delay" of relation "live_vehicle_positions" does not exist
[SQL: UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR]
[parameters: (datetime.datetime(2025, 6, 26, 13, 57, 20), '1902', '9236970', '150', 37.87966537475586, -122.51641845703125, None, None, 1, None, 1, None, None, '1902')]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-06-26 13:57:26,527 - __main__ - WARNING - Error during GTFS-RT fetch. Retrying in 29 seconds...
2025-06-26 13:57:55,742 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 13:57:57,962 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 13:57:57,964 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 13:57:57,965 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR
2025-06-26 13:57:57,966 - sqlalchemy.engine.Engine - INFO - [cached since 31.58s ago] (datetime.datetime(2025, 6, 26, 13, 57, 50), '1902', '9236970', '150', 37.87966537475586, -122.51641845703125, None, None, 1, None, 1, None, None, '1902')
2025-06-26 13:57:57,969 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-26 13:57:57,971 - __main__ - ERROR - An unexpected error occurred during GTFS-RT processing for GG: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "delay" of relation "live_vehicle_positions" does not exist
[SQL: UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR]
[parameters: (datetime.datetime(2025, 6, 26, 13, 57, 50), '1902', '9236970', '150', 37.87966537475586, -122.51641845703125, None, None, 1, None, 1, None, None, '1902')]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-26 13:57:57,974 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, self._invalidate_schema_cache_asof
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, name=self._prepared_statement_name_func()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "delay" of relation "live_vehicle_positions" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "delay" of relation "live_vehicle_positions" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 124, in fetch_and_process_gtfs_rt_data
    result = await db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1648, in orm_execute_statement
    return super().orm_execute_statement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        session,
        ^^^^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "delay" of relation "live_vehicle_positions" does not exist
[SQL: UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR]
[parameters: (datetime.datetime(2025, 6, 26, 13, 57, 50), '1902', '9236970', '150', 37.87966537475586, -122.51641845703125, None, None, 1, None, 1, None, None, '1902')]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-06-26 13:57:57,976 - __main__ - WARNING - Error during GTFS-RT fetch. Retrying in 27 seconds...
2025-06-26 13:58:25,753 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 13:58:26,057 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 13:58:26,060 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 13:58:26,063 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR
2025-06-26 13:58:26,064 - sqlalchemy.engine.Engine - INFO - [cached since 59.68s ago] (datetime.datetime(2025, 6, 26, 13, 58, 20), '1902', '9236970', '150', 37.879634857177734, -122.5163803100586, None, None, 2, None, 1, None, None, '1902')
2025-06-26 13:58:26,070 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-26 13:58:26,075 - __main__ - ERROR - An unexpected error occurred during GTFS-RT processing for GG: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "delay" of relation "live_vehicle_positions" does not exist
[SQL: UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR]
[parameters: (datetime.datetime(2025, 6, 26, 13, 58, 20), '1902', '9236970', '150', 37.879634857177734, -122.5163803100586, None, None, 2, None, 1, None, None, '1902')]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-26 13:58:26,079 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, self._invalidate_schema_cache_asof
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, name=self._prepared_statement_name_func()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "delay" of relation "live_vehicle_positions" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "delay" of relation "live_vehicle_positions" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 124, in fetch_and_process_gtfs_rt_data
    result = await db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1648, in orm_execute_statement
    return super().orm_execute_statement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        session,
        ^^^^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "delay" of relation "live_vehicle_positions" does not exist
[SQL: UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR]
[parameters: (datetime.datetime(2025, 6, 26, 13, 58, 20), '1902', '9236970', '150', 37.879634857177734, -122.5163803100586, None, None, 2, None, 1, None, None, '1902')]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-06-26 13:58:26,082 - __main__ - WARNING - Error during GTFS-RT fetch. Retrying in 29 seconds...
2025-06-26 13:58:55,762 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 13:58:56,066 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 13:58:56,069 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 13:58:56,070 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR
2025-06-26 13:58:56,071 - sqlalchemy.engine.Engine - INFO - [cached since 89.69s ago] (datetime.datetime(2025, 6, 26, 13, 58, 50), '1902', '9236970', '150', 37.878684997558594, -122.51619720458984, None, None, 2, None, 1, None, None, '1902')
2025-06-26 13:58:56,076 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-26 13:58:56,078 - __main__ - ERROR - An unexpected error occurred during GTFS-RT processing for GG: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "delay" of relation "live_vehicle_positions" does not exist
[SQL: UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR]
[parameters: (datetime.datetime(2025, 6, 26, 13, 58, 50), '1902', '9236970', '150', 37.878684997558594, -122.51619720458984, None, None, 2, None, 1, None, None, '1902')]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-26 13:58:56,083 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, self._invalidate_schema_cache_asof
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, name=self._prepared_statement_name_func()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "delay" of relation "live_vehicle_positions" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "delay" of relation "live_vehicle_positions" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 124, in fetch_and_process_gtfs_rt_data
    result = await db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1648, in orm_execute_statement
    return super().orm_execute_statement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        session,
        ^^^^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "delay" of relation "live_vehicle_positions" does not exist
[SQL: UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR]
[parameters: (datetime.datetime(2025, 6, 26, 13, 58, 50), '1902', '9236970', '150', 37.878684997558594, -122.51619720458984, None, None, 2, None, 1, None, None, '1902')]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-06-26 13:58:56,084 - __main__ - WARNING - Error during GTFS-RT fetch. Retrying in 29 seconds...
2025-06-26 13:59:25,770 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 13:59:26,105 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 13:59:26,106 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 13:59:26,107 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR
2025-06-26 13:59:26,107 - sqlalchemy.engine.Engine - INFO - [cached since 119.7s ago] (datetime.datetime(2025, 6, 26, 13, 59, 20), '1902', '9236970', '150', 37.876434326171875, -122.51158142089844, None, None, 2, None, 1, None, None, '1902')
2025-06-26 13:59:26,108 - __main__ - ERROR - An unexpected error occurred during GTFS-RT processing for GG: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: connection is closed
[SQL: UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR]
[parameters: (datetime.datetime(2025, 6, 26, 13, 59, 20), '1902', '9236970', '150', 37.876434326171875, -122.51158142089844, None, None, 2, None, 1, None, None, '1902')]
(Background on this error at: https://sqlalche.me/e/20/rvf5)
2025-06-26 13:59:26,112 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 838, in _start_transaction
    self._transaction = self._connection.transaction(
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        isolation=self.isolation_level,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        readonly=self.readonly,
        ^^^^^^^^^^^^^^^^^^^^^^^
        deferrable=self.deferrable,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 302, in transaction
    self._check_open()
    ~~~~~~~~~~~~~~~~^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 1596, in _check_open
    raise exceptions.InterfaceError('connection is closed')
asyncpg.exceptions._base.InterfaceError: connection is closed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.InterfaceError: <class 'asyncpg.exceptions._base.InterfaceError'>: connection is closed

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 124, in fetch_and_process_gtfs_rt_data
    result = await db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1648, in orm_execute_statement
    return super().orm_execute_statement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        session,
        ^^^^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 515, in _prepare_and_execute
    await adapt_connection._start_transaction()
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 845, in _start_transaction
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.InterfaceError: (sqlalchemy.dialects.postgresql.asyncpg.InterfaceError) <class 'asyncpg.exceptions._base.InterfaceError'>: connection is closed
[SQL: UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR]
[parameters: (datetime.datetime(2025, 6, 26, 13, 59, 20), '1902', '9236970', '150', 37.876434326171875, -122.51158142089844, None, None, 2, None, 1, None, None, '1902')]
(Background on this error at: https://sqlalche.me/e/20/rvf5)

2025-06-26 13:59:26,114 - __main__ - WARNING - Error during GTFS-RT fetch. Retrying in 29 seconds...
2025-06-26 13:59:55,775 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 13:59:56,115 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 13:59:56,160 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 13:59:56,161 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR
2025-06-26 13:59:56,162 - sqlalchemy.engine.Engine - INFO - [cached since 149.8s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '1902', '9236970', '150', 37.87251663208008, -122.5086669921875, None, None, 2, None, 1, None, None, '1902')
2025-06-26 13:59:56,170 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-26 13:59:56,172 - __main__ - ERROR - An unexpected error occurred during GTFS-RT processing for GG: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "delay" of relation "live_vehicle_positions" does not exist
[SQL: UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR]
[parameters: (datetime.datetime(2025, 6, 26, 13, 59, 50), '1902', '9236970', '150', 37.87251663208008, -122.5086669921875, None, None, 2, None, 1, None, None, '1902')]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-26 13:59:56,175 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, self._invalidate_schema_cache_asof
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, name=self._prepared_statement_name_func()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "delay" of relation "live_vehicle_positions" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "delay" of relation "live_vehicle_positions" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 124, in fetch_and_process_gtfs_rt_data
    result = await db.execute(stmt)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1648, in orm_execute_statement
    return super().orm_execute_statement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        session,
        ^^^^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "delay" of relation "live_vehicle_positions" does not exist
[SQL: UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR]
[parameters: (datetime.datetime(2025, 6, 26, 13, 59, 50), '1902', '9236970', '150', 37.87251663208008, -122.5086669921875, None, None, 2, None, 1, None, None, '1902')]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-06-26 13:59:56,177 - __main__ - WARNING - Error during GTFS-RT fetch. Retrying in 29 seconds...
2025-06-26 13:59:57,923 - __main__ - INFO - Starting GTFS-RT processor...
2025-06-26 13:59:57,924 - __main__ - INFO - Testing database connection...
2025-06-26 13:59:58,139 - databases - INFO - Connected to database postgresql+asyncpg://user:********@localhost:5432/transitpulse_db
2025-06-26 13:59:58,161 - databases - INFO - Disconnected from database postgresql+asyncpg://user:********@localhost:5432/transitpulse_db
2025-06-26 13:59:58,162 - __main__ - INFO - Database connection test passed!
2025-06-26 13:59:58,162 - __main__ - INFO - Starting continuous GTFS-RT processing loop...
2025-06-26 13:59:58,164 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 13:59:58,584 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 13:59:58,642 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-06-26 13:59:58,643 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:59:58,646 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-06-26 13:59:58,646 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:59:58,649 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-06-26 13:59:58,650 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 13:59:58,654 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 13:59:58,660 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,661 - sqlalchemy.engine.Engine - INFO - [generated in 0.00065s] (datetime.datetime(2025, 6, 26, 13, 59, 50), '1902', '9236970', '150', 37.87251663208008, -122.5086669921875, None, None, 2, None, 1, None, '1902')
2025-06-26 13:59:58,674 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,674 - sqlalchemy.engine.Engine - INFO - [cached since 0.01427s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '1904', '9236752', '130', 37.84523391723633, -122.47786712646484, None, None, 2, None, 1, None, '1904')
2025-06-26 13:59:58,676 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,677 - sqlalchemy.engine.Engine - INFO - [cached since 0.01672s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '1905', '9236770', '130', 37.8157844543457, -122.47817993164062, None, None, 2, None, 2, None, '1905')
2025-06-26 13:59:58,679 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,680 - sqlalchemy.engine.Engine - INFO - [cached since 0.0197s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '1909', '9236903', '101', 37.79591751098633, -122.42346954345703, None, None, 2, None, 1, None, '1909')
2025-06-26 13:59:58,682 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,682 - sqlalchemy.engine.Engine - INFO - [cached since 0.02222s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '1914', '9236953', '150', 37.970916748046875, -122.5211181640625, None, None, 2, None, 1, None, '1914')
2025-06-26 13:59:58,685 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,686 - sqlalchemy.engine.Engine - INFO - [cached since 0.02528s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '1921', '9236887', '101', 37.799415588378906, -122.44004821777344, None, None, 2, None, 2, None, '1921')
2025-06-26 13:59:58,689 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,690 - sqlalchemy.engine.Engine - INFO - [cached since 0.02972s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '1922', '9237164', '114', 37.78163146972656, -122.39706420898438, None, None, 1, None, 1, None, '1922')
2025-06-26 13:59:58,693 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,693 - sqlalchemy.engine.Engine - INFO - [cached since 0.03293s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '1923', '9236906', '101', 38.471466064453125, -122.74051666259766, None, None, 1, None, 1, None, '1923')
2025-06-26 13:59:58,695 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,695 - sqlalchemy.engine.Engine - INFO - [cached since 0.03522s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '1930', '9236904', '101', 38.10625076293945, -122.57066345214844, None, None, 1, None, 1, None, '1930')
2025-06-26 13:59:58,698 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,698 - sqlalchemy.engine.Engine - INFO - [cached since 0.03827s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '1934', '9236954', '150', 37.7859992980957, -122.40235137939453, None, None, 1, None, 1, None, '1934')
2025-06-26 13:59:58,700 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,701 - sqlalchemy.engine.Engine - INFO - [cached since 0.04043s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '1941', '9236528', '580', 37.929466247558594, -122.38601684570312, None, None, 2, None, 1, None, '1941')
2025-06-26 13:59:58,703 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,703 - sqlalchemy.engine.Engine - INFO - [cached since 0.04324s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '1946', '9236886', '101', 38.227882385253906, -122.62535095214844, None, None, 2, None, 1, None, '1946')
2025-06-26 13:59:58,707 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,707 - sqlalchemy.engine.Engine - INFO - [cached since 0.047s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '1950', '9236508', '580', 37.94821548461914, -122.49041748046875, None, None, 2, None, 1, None, '1950')
2025-06-26 13:59:58,710 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,710 - sqlalchemy.engine.Engine - INFO - [cached since 0.04982s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '2001', '9236595', '', 37.97126770019531, -122.52246856689453, None, None, 1, None, 0, None, '2001')
2025-06-26 13:59:58,712 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,713 - sqlalchemy.engine.Engine - INFO - [cached since 0.05234s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '2002', '9237119', '', 37.96580123901367, -122.50592041015625, None, None, 2, None, 0, None, '2002')
2025-06-26 13:59:58,715 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,715 - sqlalchemy.engine.Engine - INFO - [cached since 0.05508s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '2003', '9237118', '', 37.894466400146484, -122.51605224609375, None, None, 2, None, 0, None, '2003')
2025-06-26 13:59:58,717 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,717 - sqlalchemy.engine.Engine - INFO - [cached since 0.05707s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '2005', '9237131', '', 37.9254150390625, -122.51398468017578, None, None, 1, None, 0, None, '2005')
2025-06-26 13:59:58,719 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,720 - sqlalchemy.engine.Engine - INFO - [cached since 0.0596s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '2006', '9236825', '', 38.11344909667969, -122.56556701660156, None, None, 1, None, 0, None, '2006')
2025-06-26 13:59:58,722 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,722 - sqlalchemy.engine.Engine - INFO - [cached since 0.06209s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '2008', '9236786', '', 37.87220001220703, -122.51153564453125, None, None, 1, None, 0, None, '2008')
2025-06-26 13:59:58,725 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,725 - sqlalchemy.engine.Engine - INFO - [cached since 0.06506s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '2009', '9236633', '', 38.00868225097656, -122.5492172241211, None, None, 1, None, 0, None, '2009')
2025-06-26 13:59:58,728 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,729 - sqlalchemy.engine.Engine - INFO - [cached since 0.06855s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '2010', '9236810', '', 37.97093200683594, -122.52261352539062, None, None, 1, None, 0, None, '2010')
2025-06-26 13:59:58,733 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,733 - sqlalchemy.engine.Engine - INFO - [cached since 0.07307s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '2011', '9237096', '', 37.87248229980469, -122.51166534423828, None, None, 1, None, 0, None, '2011')
2025-06-26 13:59:58,736 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,736 - sqlalchemy.engine.Engine - INFO - [cached since 0.07618s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '2401', '9236704', '', 37.96168518066406, -122.50184631347656, None, None, 2, None, 0, None, '2401')
2025-06-26 13:59:58,739 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,739 - sqlalchemy.engine.Engine - INFO - [cached since 0.07892s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '2402', '9236695', '', 37.98659896850586, -122.58323669433594, None, None, 2, None, 0, None, '2402')
2025-06-26 13:59:58,742 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,742 - sqlalchemy.engine.Engine - INFO - [cached since 0.08219s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '2404', '9236641', '', 37.96408462524414, -122.51216888427734, None, None, 2, None, 0, None, '2404')
2025-06-26 13:59:58,746 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,747 - sqlalchemy.engine.Engine - INFO - [cached since 0.08646s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '2405', '9236845', '', 37.970733642578125, -122.52241516113281, None, None, 1, None, 0, None, '2405')
2025-06-26 13:59:58,751 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,752 - sqlalchemy.engine.Engine - INFO - [cached since 0.0914s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '2406', '9236574', '', 37.97105026245117, -122.5225830078125, None, None, 1, None, 0, None, '2406')
2025-06-26 13:59:58,755 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 13:59:58,756 - sqlalchemy.engine.Engine - INFO - [cached since 0.09555s ago] (datetime.datetime(2025, 6, 26, 13, 59, 50), '961', '9236905', '101', 38.4387321472168, -122.71533203125, None, None, 2, None, 0, None, '961')
2025-06-26 13:59:58,764 - sqlalchemy.engine.Engine - INFO - INSERT INTO live_vehicle_positions (timestamp, vehicle_id, trip_id, route_id, latitude, longitude, bearing, speed, current_status, congestion_level, occupancy_status, stop_id) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::VARCHAR, p3::VARC ... 5607 characters truncated ... ounter) ORDER BY sen_counter RETURNING live_vehicle_positions.id, live_vehicle_positions.id AS id__1
2025-06-26 13:59:58,765 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s (insertmanyvalues) 1/1 (ordered)] (datetime.datetime(2025, 6, 26, 13, 59, 50), '1902', '9236970', '150', 37.87251663208008, -122.5086669921875, None, None, 2, None, 1, None, datetime.datetime(2025, 6, 26, 13, 59, 50), '1904', '9236752', '130', 37.84523391723633, -122.47786712646484, None, None, 2, None, 1, None, datetime.datetime(2025, 6, 26, 13, 59, 50), '1905', '9236770', '130', 37.8157844543457, -122.47817993164062, None, None, 2, None, 2, None, datetime.datetime(2025, 6, 26, 13, 59, 50), '1909', '9236903', '101', 37.79591751098633, -122.42346954345703, None, None, 2, None, 1, None, datetime.datetime(2025, 6, 26, 13, 59, 50), '1914' ... 236 parameters truncated ... 0, None, datetime.datetime(2025, 6, 26, 13, 59, 50), '2404', '9236641', '', 37.96408462524414, -122.51216888427734, None, None, 2, None, 0, None, datetime.datetime(2025, 6, 26, 13, 59, 50), '2405', '9236845', '', 37.970733642578125, -122.52241516113281, None, None, 1, None, 0, None, datetime.datetime(2025, 6, 26, 13, 59, 50), '2406', '9236574', '', 37.97105026245117, -122.5225830078125, None, None, 1, None, 0, None, datetime.datetime(2025, 6, 26, 13, 59, 50), '961', '9236905', '101', 38.4387321472168, -122.71533203125, None, None, 2, None, 0, None)
2025-06-26 13:59:58,778 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-26 13:59:58,783 - __main__ - INFO - Processed GTFS-RT for GG: 0 vehicles updated, 28 new vehicles added.
2025-06-26 13:59:58,784 - __main__ - INFO - Processing cycle completed in 0.62 seconds.
2025-06-26 13:59:58,785 - __main__ - INFO - Sleeping for 29 seconds...
2025-06-26 14:00:25,778 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 14:00:26,111 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 14:00:26,115 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 14:00:26,117 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR
2025-06-26 14:00:26,118 - sqlalchemy.engine.Engine - INFO - [cached since 179.7s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '1902', '9236970', '150', 37.87153244018555, -122.51046752929688, None, None, 2, None, 1, None, None, '1902')
2025-06-26 14:00:26,127 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-26 14:00:26,131 - __main__ - ERROR - An unexpected error occurred during GTFS-RT processing for GG: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "delay" of relation "live_vehicle_positions" does not exist
[SQL: UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR]
[parameters: (datetime.datetime(2025, 6, 26, 14, 0, 20), '1902', '9236970', '150', 37.87153244018555, -122.51046752929688, None, None, 2, None, 1, None, None, '1902')]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-26 14:00:26,137 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, self._invalidate_schema_cache_asof
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, name=self._prepared_statement_name_func()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "delay" of relation "live_vehicle_positions" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "delay" of relation "live_vehicle_positions" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 124, in fetch_and_process_gtfs_rt_data
    stmt = update(LiveVehiclePosition).where(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1648, in orm_execute_statement
    return super().orm_execute_statement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        session,
        ^^^^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "delay" of relation "live_vehicle_positions" does not exist
[SQL: UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR]
[parameters: (datetime.datetime(2025, 6, 26, 14, 0, 20), '1902', '9236970', '150', 37.87153244018555, -122.51046752929688, None, None, 2, None, 1, None, None, '1902')]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-06-26 14:00:26,138 - __main__ - WARNING - Error during GTFS-RT fetch. Retrying in 29 seconds...
2025-06-26 14:00:28,178 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 14:00:28,595 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 14:00:28,597 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 14:00:28,598 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,599 - sqlalchemy.engine.Engine - INFO - [cached since 29.94s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '1902', '9236970', '150', 37.87153244018555, -122.51046752929688, None, None, 2, None, 1, None, '1902')
2025-06-26 14:00:28,604 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,604 - sqlalchemy.engine.Engine - INFO - [cached since 29.94s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '1904', '9236752', '130', 37.84698486328125, -122.4794692993164, None, None, 2, None, 1, None, '1904')
2025-06-26 14:00:28,608 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,609 - sqlalchemy.engine.Engine - INFO - [cached since 29.95s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '1905', '9236770', '130', 37.8114013671875, -122.47766876220703, None, None, 2, None, 2, None, '1905')
2025-06-26 14:00:28,613 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,617 - sqlalchemy.engine.Engine - INFO - [cached since 29.96s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '1909', '9236903', '101', 37.79591751098633, -122.42346954345703, None, None, 2, None, 1, None, '1909')
2025-06-26 14:00:28,623 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,625 - sqlalchemy.engine.Engine - INFO - [cached since 29.96s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '1914', '9236953', '150', 37.97098159790039, -122.52110290527344, None, None, 2, None, 1, None, '1914')
2025-06-26 14:00:28,632 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,634 - sqlalchemy.engine.Engine - INFO - [cached since 29.97s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '1921', '9236887', '101', 37.799049377441406, -122.44290161132812, None, None, 2, None, 2, None, '1921')
2025-06-26 14:00:28,637 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,638 - sqlalchemy.engine.Engine - INFO - [cached since 29.98s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '1922', '9237164', '114', 37.78163146972656, -122.39706420898438, None, None, 1, None, 1, None, '1922')
2025-06-26 14:00:28,642 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,642 - sqlalchemy.engine.Engine - INFO - [cached since 29.98s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '1923', '9236906', '101', 38.471466064453125, -122.74051666259766, None, None, 1, None, 1, None, '1923')
2025-06-26 14:00:28,645 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,646 - sqlalchemy.engine.Engine - INFO - [cached since 29.99s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '1930', '9236904', '101', 38.10625076293945, -122.57066345214844, None, None, 1, None, 1, None, '1930')
2025-06-26 14:00:28,650 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,651 - sqlalchemy.engine.Engine - INFO - [cached since 29.99s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '1934', '9236954', '150', 37.7859992980957, -122.40235137939453, None, None, 1, None, 1, None, '1934')
2025-06-26 14:00:28,655 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,656 - sqlalchemy.engine.Engine - INFO - [cached since 29.99s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '1941', '9236528', '580', 37.929100036621094, -122.38700103759766, None, None, 2, None, 1, None, '1941')
2025-06-26 14:00:28,659 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,660 - sqlalchemy.engine.Engine - INFO - [cached since 30s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '1946', '9236886', '101', 38.22890090942383, -122.62740325927734, None, None, 2, None, 1, None, '1946')
2025-06-26 14:00:28,664 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,665 - sqlalchemy.engine.Engine - INFO - [cached since 30s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '1950', '9236508', '580', 37.94675064086914, -122.49041748046875, None, None, 2, None, 1, None, '1950')
2025-06-26 14:00:28,668 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,669 - sqlalchemy.engine.Engine - INFO - [cached since 30.01s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '2001', '9236595', '', 37.97129821777344, -122.52245330810547, None, None, 2, None, 0, None, '2001')
2025-06-26 14:00:28,672 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,672 - sqlalchemy.engine.Engine - INFO - [cached since 30.01s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '2002', '9237119', '', 37.965232849121094, -122.50814819335938, None, None, 2, None, 0, None, '2002')
2025-06-26 14:00:28,675 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,676 - sqlalchemy.engine.Engine - INFO - [cached since 30.02s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '2003', '9237118', '', 37.891265869140625, -122.51631927490234, None, None, 2, None, 0, None, '2003')
2025-06-26 14:00:28,679 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,680 - sqlalchemy.engine.Engine - INFO - [cached since 30.02s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '2005', '9237131', '', 37.92665100097656, -122.51470184326172, None, None, 2, None, 0, None, '2005')
2025-06-26 14:00:28,684 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,684 - sqlalchemy.engine.Engine - INFO - [cached since 30.02s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '2006', '9236825', '', 38.11344909667969, -122.56556701660156, None, None, 1, None, 0, None, '2006')
2025-06-26 14:00:28,687 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,688 - sqlalchemy.engine.Engine - INFO - [cached since 30.03s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '2008', '9236786', '', 37.87220001220703, -122.51155090332031, None, None, 1, None, 0, None, '2008')
2025-06-26 14:00:28,690 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,691 - sqlalchemy.engine.Engine - INFO - [cached since 30.03s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '2009', '9236633', '', 38.00868225097656, -122.54923248291016, None, None, 1, None, 0, None, '2009')
2025-06-26 14:00:28,694 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,695 - sqlalchemy.engine.Engine - INFO - [cached since 30.03s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '2010', '9236810', '', 37.97093200683594, -122.52261352539062, None, None, 1, None, 0, None, '2010')
2025-06-26 14:00:28,698 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,699 - sqlalchemy.engine.Engine - INFO - [cached since 30.04s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '2011', '9237096', '', 37.87248229980469, -122.51166534423828, None, None, 1, None, 0, None, '2011')
2025-06-26 14:00:28,702 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,703 - sqlalchemy.engine.Engine - INFO - [cached since 30.04s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '2401', '9236704', '', 37.96303176879883, -122.50198364257812, None, None, 2, None, 0, None, '2401')
2025-06-26 14:00:28,705 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,706 - sqlalchemy.engine.Engine - INFO - [cached since 30.05s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '2402', '9236695', '', 37.98659896850586, -122.58038330078125, None, None, 2, None, 0, None, '2402')
2025-06-26 14:00:28,708 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,709 - sqlalchemy.engine.Engine - INFO - [cached since 30.05s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '2404', '9236641', '', 37.96551513671875, -122.51471710205078, None, None, 2, None, 0, None, '2404')
2025-06-26 14:00:28,711 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,712 - sqlalchemy.engine.Engine - INFO - [cached since 30.05s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '2405', '9236845', '', 37.97074890136719, -122.52241516113281, None, None, 1, None, 0, None, '2405')
2025-06-26 14:00:28,716 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,717 - sqlalchemy.engine.Engine - INFO - [cached since 30.06s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '2406', '9236574', '', 37.97086715698242, -122.5225830078125, None, None, 2, None, 0, None, '2406')
2025-06-26 14:00:28,720 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:00:28,721 - sqlalchemy.engine.Engine - INFO - [cached since 30.06s ago] (datetime.datetime(2025, 6, 26, 14, 0, 20), '961', '9236905', '101', 38.43899917602539, -122.71478271484375, None, None, 2, None, 0, None, '961')
2025-06-26 14:00:28,723 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-26 14:00:28,727 - __main__ - INFO - Processed GTFS-RT for GG: 28 vehicles updated, 0 new vehicles added.
2025-06-26 14:00:28,728 - __main__ - INFO - Processing cycle completed in 0.55 seconds.
2025-06-26 14:00:28,728 - __main__ - INFO - Sleeping for 29 seconds...
2025-06-26 14:00:53,003 - __main__ - INFO - GTFS-RT processor stopped by user.
2025-06-26 14:00:53,003 - __main__ - INFO - GTFS-RT processor stopped.
2025-06-26 14:00:55,788 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 14:00:56,170 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 14:00:56,171 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 14:00:56,173 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR
2025-06-26 14:00:56,174 - sqlalchemy.engine.Engine - INFO - [cached since 209.8s ago] (datetime.datetime(2025, 6, 26, 14, 0, 50), '1902', '9236970', '150', 37.87198257446289, -122.5113296508789, None, None, 1, None, 1, None, None, '1902')
2025-06-26 14:00:56,179 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-06-26 14:00:56,181 - __main__ - ERROR - An unexpected error occurred during GTFS-RT processing for GG: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "delay" of relation "live_vehicle_positions" does not exist
[SQL: UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR]
[parameters: (datetime.datetime(2025, 6, 26, 14, 0, 50), '1902', '9236970', '150', 37.87198257446289, -122.5113296508789, None, None, 1, None, 1, None, None, '1902')]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-26 14:00:56,184 - __main__ - ERROR - Traceback (most recent call last):
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 521, in _prepare_and_execute
    prepared_stmt, attributes = await adapt_connection._prepare(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, self._invalidate_schema_cache_asof
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 768, in _prepare
    prepared_stmt = await self._connection.prepare(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        operation, name=self._prepared_statement_name_func()
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 635, in prepare
    return await self._prepare(
           ^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 653, in _prepare
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\asyncpg\connection.py", line 432, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
    )
    ^
  File "asyncpg\\protocol\\protocol.pyx", line 165, in prepare
asyncpg.exceptions.UndefinedColumnError: column "delay" of relation "live_vehicle_positions" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.UndefinedColumnError'>: column "delay" of relation "live_vehicle_positions" does not exist

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Singhb\CascadeProjects\transitpulse\transitpulse-backend\data_ingestion\gtfs_rt_processor.py", line 124, in fetch_and_process_gtfs_rt_data
    stmt = update(LiveVehiclePosition).where(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\ext\asyncio\session.py", line 463, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 2365, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\session.py", line 2251, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\bulk_persistence.py", line 1648, in orm_execute_statement
    return super().orm_execute_statement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        session,
        ^^^^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\orm\context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1415, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\sql\elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1842, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\engine\default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 580, in execute
    self._adapt_connection.await_(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self._prepare_and_execute(operation, parameters)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 558, in _prepare_and_execute
    self._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 508, in _handle_exception
    self._adapt_connection._handle_exception(error)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^
  File "C:\Users\Singhb\AppData\Local\Programs\Python\Python313\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py", line 792, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "delay" of relation "live_vehicle_positions" does not exist
[SQL: UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR, delay=$13::INTEGER WHERE live_vehicle_positions.vehicle_id = $14::VARCHAR]
[parameters: (datetime.datetime(2025, 6, 26, 14, 0, 50), '1902', '9236970', '150', 37.87198257446289, -122.5113296508789, None, None, 1, None, 1, None, None, '1902')]
(Background on this error at: https://sqlalche.me/e/20/f405)

2025-06-26 14:00:56,186 - __main__ - WARNING - Error during GTFS-RT fetch. Retrying in 29 seconds...
2025-06-26 14:01:16,016 - __main__ - INFO - GTFS-RT processor stopped by user.
2025-06-26 14:01:16,016 - __main__ - INFO - GTFS-RT processor stopped.
2025-06-26 14:01:34,367 - __main__ - INFO - Starting GTFS-RT processor...
2025-06-26 14:01:34,368 - __main__ - INFO - Testing database connection...
2025-06-26 14:01:34,608 - databases - INFO - Connected to database postgresql+asyncpg://user:********@localhost:5432/transitpulse_db
2025-06-26 14:01:34,620 - databases - INFO - Disconnected from database postgresql+asyncpg://user:********@localhost:5432/transitpulse_db
2025-06-26 14:01:34,620 - __main__ - INFO - Database connection test passed!
2025-06-26 14:01:34,621 - __main__ - INFO - Starting continuous GTFS-RT processing loop...
2025-06-26 14:01:34,622 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 14:01:35,100 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 14:01:35,147 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-06-26 14:01:35,147 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 14:01:35,151 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-06-26 14:01:35,151 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 14:01:35,155 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-06-26 14:01:35,155 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 14:01:35,158 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 14:01:35,160 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,160 - sqlalchemy.engine.Engine - INFO - [generated in 0.00067s] (datetime.datetime(2025, 6, 26, 14, 1, 20), '1902', '9236970', '150', 37.87198257446289, -122.5113296508789, None, None, 1, None, 1, None, '1902')
2025-06-26 14:01:35,166 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,167 - sqlalchemy.engine.Engine - INFO - [cached since 0.007416s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '1904', '9236752', '130', 37.849117279052734, -122.480712890625, None, None, 2, None, 1, None, '1904')
2025-06-26 14:01:35,169 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,170 - sqlalchemy.engine.Engine - INFO - [cached since 0.01069s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '1905', '9236770', '130', 37.80670166015625, -122.47540283203125, None, None, 1, None, 2, None, '1905')
2025-06-26 14:01:35,173 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,173 - sqlalchemy.engine.Engine - INFO - [cached since 0.01387s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '1909', '9236903', '101', 37.792198181152344, -122.42276763916016, None, None, 2, None, 1, None, '1909')
2025-06-26 14:01:35,176 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,177 - sqlalchemy.engine.Engine - INFO - [cached since 0.01747s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '1914', '9236953', '150', 37.97114944458008, -122.52227020263672, None, None, 2, None, 1, None, '1914')
2025-06-26 14:01:35,179 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,179 - sqlalchemy.engine.Engine - INFO - [cached since 0.02001s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '1921', '9236887', '101', 37.799232482910156, -122.44528198242188, None, None, 2, None, 2, None, '1921')
2025-06-26 14:01:35,182 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,182 - sqlalchemy.engine.Engine - INFO - [cached since 0.02263s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '1922', '9237164', '114', 37.78163146972656, -122.39706420898438, None, None, 1, None, 1, None, '1922')
2025-06-26 14:01:35,184 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,184 - sqlalchemy.engine.Engine - INFO - [cached since 0.02456s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '1923', '9236906', '101', 38.471466064453125, -122.74051666259766, None, None, 1, None, 1, None, '1923')
2025-06-26 14:01:35,186 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,187 - sqlalchemy.engine.Engine - INFO - [cached since 0.02723s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '1930', '9236904', '101', 38.10625076293945, -122.57066345214844, None, None, 1, None, 1, None, '1930')
2025-06-26 14:01:35,190 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,190 - sqlalchemy.engine.Engine - INFO - [cached since 0.03076s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '1934', '9236954', '150', 37.785865783691406, -122.40245056152344, None, None, 2, None, 1, None, '1934')
2025-06-26 14:01:35,192 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,193 - sqlalchemy.engine.Engine - INFO - [cached since 0.03328s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '1941', '9236528', '580', 37.928768157958984, -122.38671875, None, None, 2, None, 1, None, '1941')
2025-06-26 14:01:35,194 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,195 - sqlalchemy.engine.Engine - INFO - [cached since 0.03548s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '1946', '9236886', '101', 38.231300354003906, -122.63365173339844, None, None, 2, None, 1, None, '1946')
2025-06-26 14:01:35,197 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,197 - sqlalchemy.engine.Engine - INFO - [cached since 0.0378s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '1950', '9236508', '580', 37.94499969482422, -122.48284912109375, None, None, 2, None, 1, None, '1950')
2025-06-26 14:01:35,199 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,199 - sqlalchemy.engine.Engine - INFO - [cached since 0.03992s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '2001', '9236595', '', 37.971317291259766, -122.52245330810547, None, None, 2, None, 0, None, '2001')
2025-06-26 14:01:35,201 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,202 - sqlalchemy.engine.Engine - INFO - [cached since 0.04218s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '2002', '9237119', '', 37.96455001831055, -122.5089340209961, None, None, 2, None, 0, None, '2002')
2025-06-26 14:01:35,204 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,205 - sqlalchemy.engine.Engine - INFO - [cached since 0.04535s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '2003', '9237118', '', 37.88705062866211, -122.51631927490234, None, None, 2, None, 0, None, '2003')
2025-06-26 14:01:35,207 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,208 - sqlalchemy.engine.Engine - INFO - [cached since 0.04831s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '2005', '9237131', '', 37.93641662597656, -122.51661682128906, None, None, 2, None, 0, None, '2005')
2025-06-26 14:01:35,210 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,210 - sqlalchemy.engine.Engine - INFO - [cached since 0.05088s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '2006', '9236825', '', 38.11344909667969, -122.56558227539062, None, None, 1, None, 0, None, '2006')
2025-06-26 14:01:35,212 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,212 - sqlalchemy.engine.Engine - INFO - [cached since 0.05293s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '2008', '9236786', '', 37.87220001220703, -122.51155090332031, None, None, 1, None, 0, None, '2008')
2025-06-26 14:01:35,214 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,215 - sqlalchemy.engine.Engine - INFO - [cached since 0.05524s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '2009', '9236633', '', 38.00868225097656, -122.54923248291016, None, None, 1, None, 0, None, '2009')
2025-06-26 14:01:35,216 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,217 - sqlalchemy.engine.Engine - INFO - [cached since 0.05728s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '2010', '9236810', '', 37.97064971923828, -122.52252960205078, None, None, 2, None, 0, None, '2010')
2025-06-26 14:01:35,219 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,219 - sqlalchemy.engine.Engine - INFO - [cached since 0.05959s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '2011', '9237096', '', 37.87248229980469, -122.51165008544922, None, None, 1, None, 0, None, '2011')
2025-06-26 14:01:35,221 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,222 - sqlalchemy.engine.Engine - INFO - [cached since 0.06235s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '2401', '9236704', '', 37.96445083618164, -122.5013198852539, None, None, 2, None, 0, None, '2401')
2025-06-26 14:01:35,224 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,224 - sqlalchemy.engine.Engine - INFO - [cached since 0.06462s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '2402', '9236695', '', 37.985084533691406, -122.57371520996094, None, None, 2, None, 0, None, '2402')
2025-06-26 14:01:35,228 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,228 - sqlalchemy.engine.Engine - INFO - [cached since 0.06875s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '2404', '9236641', '', 37.96841812133789, -122.51944732666016, None, None, 2, None, 0, None, '2404')
2025-06-26 14:01:35,231 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,231 - sqlalchemy.engine.Engine - INFO - [cached since 0.07178s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '2405', '9236845', '', 37.967899322509766, -122.5199203491211, None, None, 2, None, 0, None, '2405')
2025-06-26 14:01:35,233 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,233 - sqlalchemy.engine.Engine - INFO - [cached since 0.07375s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '2406', '9236574', '', 37.97060012817383, -122.52168273925781, None, None, 2, None, 0, None, '2406')
2025-06-26 14:01:35,235 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:01:35,235 - sqlalchemy.engine.Engine - INFO - [cached since 0.07598s ago] (datetime.datetime(2025, 6, 26, 14, 1, 20), '961', '9236905', '101', 38.43880081176758, -122.7136001586914, None, None, 1, None, 0, None, '961')
2025-06-26 14:01:35,237 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-26 14:01:35,240 - __main__ - INFO - Processed GTFS-RT for GG: 28 vehicles updated, 0 new vehicles added.
2025-06-26 14:01:35,241 - __main__ - INFO - Processing cycle completed in 0.62 seconds.
2025-06-26 14:01:35,242 - __main__ - INFO - Sleeping for 29 seconds...
2025-06-26 14:02:04,627 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 14:02:07,999 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 14:02:08,001 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 14:02:08,002 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,004 - sqlalchemy.engine.Engine - INFO - [cached since 32.84s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '1902', '9236970', '150', 37.87198257446289, -122.5113296508789, None, None, 1, None, 1, None, '1902')
2025-06-26 14:02:08,009 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,012 - sqlalchemy.engine.Engine - INFO - [cached since 32.85s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '1904', '9236752', '130', 37.85041809082031, -122.47959899902344, None, None, 2, None, 1, None, '1904')
2025-06-26 14:02:08,018 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,021 - sqlalchemy.engine.Engine - INFO - [cached since 32.86s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '1905', '9236770', '130', 37.80543518066406, -122.47380065917969, None, None, 2, None, 1, None, '1905')
2025-06-26 14:02:08,024 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,026 - sqlalchemy.engine.Engine - INFO - [cached since 32.87s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '1909', '9236903', '101', 37.790565490722656, -122.42241668701172, None, None, 2, None, 1, None, '1909')
2025-06-26 14:02:08,029 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,031 - sqlalchemy.engine.Engine - INFO - [cached since 32.87s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '1921', '9236887', '101', 37.8001823425293, -122.44666290283203, None, None, 1, None, 2, None, '1921')
2025-06-26 14:02:08,036 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,038 - sqlalchemy.engine.Engine - INFO - [cached since 32.88s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '1922', '9237164', '114', 37.78163146972656, -122.39706420898438, None, None, 1, None, 1, None, '1922')
2025-06-26 14:02:08,043 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,045 - sqlalchemy.engine.Engine - INFO - [cached since 32.88s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '1923', '9236906', '101', 38.471466064453125, -122.74051666259766, None, None, 1, None, 1, None, '1923')
2025-06-26 14:02:08,050 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,052 - sqlalchemy.engine.Engine - INFO - [cached since 32.89s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '1930', '9236904', '101', 38.10625076293945, -122.57066345214844, None, None, 1, None, 1, None, '1930')
2025-06-26 14:02:08,057 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,058 - sqlalchemy.engine.Engine - INFO - [cached since 32.9s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '1934', '9236954', '150', 37.78544998168945, -122.40299987792969, None, None, 2, None, 1, None, '1934')
2025-06-26 14:02:08,064 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,066 - sqlalchemy.engine.Engine - INFO - [cached since 32.91s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '1941', '9236528', '580', 37.92898178100586, -122.3868637084961, None, None, 2, None, 1, None, '1941')
2025-06-26 14:02:08,072 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,074 - sqlalchemy.engine.Engine - INFO - [cached since 32.91s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '1946', '9236886', '101', 38.2325325012207, -122.63673400878906, None, None, 2, None, 1, None, '1946')
2025-06-26 14:02:08,080 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,081 - sqlalchemy.engine.Engine - INFO - [cached since 32.92s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '1950', '9236508', '580', 37.94350051879883, -122.48048400878906, None, None, 2, None, 1, None, '1950')
2025-06-26 14:02:08,087 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,088 - sqlalchemy.engine.Engine - INFO - [cached since 32.93s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '2001', '9236595', '', 37.971351623535156, -122.52245330810547, None, None, 2, None, 0, None, '2001')
2025-06-26 14:02:08,093 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,094 - sqlalchemy.engine.Engine - INFO - [cached since 32.93s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '2002', '9237119', '', 37.96318435668945, -122.51014709472656, None, None, 2, None, 0, None, '2002')
2025-06-26 14:02:08,100 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,101 - sqlalchemy.engine.Engine - INFO - [cached since 32.94s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '2003', '9237118', '', 37.88813400268555, -122.51715087890625, None, None, 2, None, 0, None, '2003')
2025-06-26 14:02:08,107 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,108 - sqlalchemy.engine.Engine - INFO - [cached since 32.95s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '2005', '9237131', '', 37.93864822387695, -122.51609802246094, None, None, 1, None, 0, None, '2005')
2025-06-26 14:02:08,114 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,115 - sqlalchemy.engine.Engine - INFO - [cached since 32.96s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '2006', '9236825', '', 38.113433837890625, -122.56558227539062, None, None, 1, None, 0, None, '2006')
2025-06-26 14:02:08,121 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,123 - sqlalchemy.engine.Engine - INFO - [cached since 32.96s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '2008', '9236786', '', 37.87314987182617, -122.51183319091797, None, None, 2, None, 0, None, '2008')
2025-06-26 14:02:08,130 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,132 - sqlalchemy.engine.Engine - INFO - [cached since 32.97s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '2009', '9236633', '', 38.00868225097656, -122.54923248291016, None, None, 1, None, 0, None, '2009')
2025-06-26 14:02:08,140 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,142 - sqlalchemy.engine.Engine - INFO - [cached since 32.98s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '2010', '9236810', '', 37.97063446044922, -122.52252960205078, None, None, 2, None, 0, None, '2010')
2025-06-26 14:02:08,148 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,149 - sqlalchemy.engine.Engine - INFO - [cached since 32.99s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '2011', '9237096', '', 37.87248229980469, -122.51166534423828, None, None, 1, None, 0, None, '2011')
2025-06-26 14:02:08,155 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,157 - sqlalchemy.engine.Engine - INFO - [cached since 33s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '2401', '9236704', '', 37.966148376464844, -122.50035095214844, None, None, 2, None, 0, None, '2401')
2025-06-26 14:02:08,162 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,163 - sqlalchemy.engine.Engine - INFO - [cached since 33s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '2402', '9236695', '', 37.98411560058594, -122.57201385498047, None, None, 2, None, 0, None, '2402')
2025-06-26 14:02:08,168 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,169 - sqlalchemy.engine.Engine - INFO - [cached since 33.01s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '2404', '9236641', '', 37.970184326171875, -122.51899719238281, None, None, 2, None, 0, None, '2404')
2025-06-26 14:02:08,174 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,176 - sqlalchemy.engine.Engine - INFO - [cached since 33.02s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '2405', '9236845', '', 37.964534759521484, -122.513916015625, None, None, 2, None, 0, None, '2405')
2025-06-26 14:02:08,180 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,182 - sqlalchemy.engine.Engine - INFO - [cached since 33.02s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '2406', '9236574', '', 37.97064971923828, -122.52113342285156, None, None, 2, None, 0, None, '2406')
2025-06-26 14:02:08,186 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:08,187 - sqlalchemy.engine.Engine - INFO - [cached since 33.03s ago] (datetime.datetime(2025, 6, 26, 14, 1, 50), '961', '9236905', '101', 38.43883514404297, -122.7136001586914, None, None, 1, None, 0, None, '961')
2025-06-26 14:02:08,191 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-26 14:02:08,197 - __main__ - INFO - Processed GTFS-RT for GG: 27 vehicles updated, 0 new vehicles added.
2025-06-26 14:02:08,199 - __main__ - INFO - Processing cycle completed in 3.57 seconds.
2025-06-26 14:02:08,200 - __main__ - INFO - Sleeping for 26 seconds...
2025-06-26 14:02:34,099 - __main__ - INFO - GTFS-RT processor stopped by user.
2025-06-26 14:02:34,099 - __main__ - INFO - GTFS-RT processor stopped.
2025-06-26 14:02:45,335 - __main__ - INFO - Starting GTFS-RT processor...
2025-06-26 14:02:45,336 - __main__ - INFO - Testing database connection...
2025-06-26 14:02:45,546 - databases - INFO - Connected to database postgresql+asyncpg://user:********@localhost:5432/transitpulse_db
2025-06-26 14:02:45,559 - databases - INFO - Disconnected from database postgresql+asyncpg://user:********@localhost:5432/transitpulse_db
2025-06-26 14:02:45,559 - __main__ - INFO - Database connection test passed!
2025-06-26 14:02:45,560 - __main__ - INFO - Starting continuous GTFS-RT processing loop...
2025-06-26 14:02:45,562 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 14:02:45,997 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 14:02:46,042 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-06-26 14:02:46,042 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 14:02:46,046 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-06-26 14:02:46,046 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 14:02:46,049 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-06-26 14:02:46,049 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 14:02:46,052 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 14:02:46,058 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,058 - sqlalchemy.engine.Engine - INFO - [generated in 0.00065s] (datetime.datetime(2025, 6, 26, 14, 2, 30), '1902', '9236970', '150', 37.87293243408203, -122.51183319091797, None, None, 2, None, 1, None, '1902')
2025-06-26 14:02:46,063 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,064 - sqlalchemy.engine.Engine - INFO - [cached since 0.006578s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '1904', '9236752', '130', 37.85409927368164, -122.47889709472656, None, None, 2, None, 1, None, '1904')
2025-06-26 14:02:46,066 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,067 - sqlalchemy.engine.Engine - INFO - [cached since 0.009088s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '1905', '9236770', '130', 37.80183410644531, -122.4642333984375, None, None, 2, None, 1, None, '1905')
2025-06-26 14:02:46,069 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,070 - sqlalchemy.engine.Engine - INFO - [cached since 0.01256s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '1909', '9236903', '101', 37.78923416137695, -122.42213439941406, None, None, 2, None, 1, None, '1909')
2025-06-26 14:02:46,073 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,074 - sqlalchemy.engine.Engine - INFO - [cached since 0.01626s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '1921', '9236887', '101', 37.800315856933594, -122.44685363769531, None, None, 2, None, 2, None, '1921')
2025-06-26 14:02:46,076 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,077 - sqlalchemy.engine.Engine - INFO - [cached since 0.01947s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '1922', '9237164', '114', 37.78163146972656, -122.39706420898438, None, None, 1, None, 1, None, '1922')
2025-06-26 14:02:46,080 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,080 - sqlalchemy.engine.Engine - INFO - [cached since 0.02263s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '1923', '9236906', '101', 38.471466064453125, -122.74051666259766, None, None, 1, None, 1, None, '1923')
2025-06-26 14:02:46,082 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,083 - sqlalchemy.engine.Engine - INFO - [cached since 0.02584s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '1930', '9236904', '101', 38.10625076293945, -122.57066345214844, None, None, 1, None, 1, None, '1930')
2025-06-26 14:02:46,086 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,086 - sqlalchemy.engine.Engine - INFO - [cached since 0.02863s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '1934', '9236954', '150', 37.78525161743164, -122.40323638916016, None, None, 2, None, 1, None, '1934')
2025-06-26 14:02:46,089 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,089 - sqlalchemy.engine.Engine - INFO - [cached since 0.0319s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '1941', '9236528', '580', 37.92901611328125, -122.3864974975586, None, None, 2, None, 1, None, '1941')
2025-06-26 14:02:46,092 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,093 - sqlalchemy.engine.Engine - INFO - [cached since 0.03532s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '1946', '9236886', '101', 38.234718322753906, -122.63556671142578, None, None, 2, None, 1, None, '1946')
2025-06-26 14:02:46,095 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,096 - sqlalchemy.engine.Engine - INFO - [cached since 0.03812s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '1950', '9236508', '580', 37.942317962646484, -122.4768295288086, None, None, 2, None, 1, None, '1950')
2025-06-26 14:02:46,099 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,100 - sqlalchemy.engine.Engine - INFO - [cached since 0.04259s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '2001', '9236595', '', 37.971431732177734, -122.52256774902344, None, None, 2, None, 0, None, '2001')
2025-06-26 14:02:46,103 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,104 - sqlalchemy.engine.Engine - INFO - [cached since 0.04685s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '2002', '9237119', '', 37.96495056152344, -122.51373291015625, None, None, 2, None, 0, None, '2002')
2025-06-26 14:02:46,108 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,109 - sqlalchemy.engine.Engine - INFO - [cached since 0.05125s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '2003', '9237118', '', 37.887332916259766, -122.51691436767578, None, None, 2, None, 0, None, '2003')
2025-06-26 14:02:46,111 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,111 - sqlalchemy.engine.Engine - INFO - [cached since 0.05381s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '2005', '9237131', '', 37.93994903564453, -122.5158462524414, None, None, 2, None, 0, None, '2005')
2025-06-26 14:02:46,113 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,114 - sqlalchemy.engine.Engine - INFO - [cached since 0.05611s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '2006', '9236825', '', 38.11344909667969, -122.56558227539062, None, None, 1, None, 0, None, '2006')
2025-06-26 14:02:46,116 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,116 - sqlalchemy.engine.Engine - INFO - [cached since 0.05869s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '2008', '9236786', '', 37.87333297729492, -122.51155090332031, None, None, 2, None, 0, None, '2008')
2025-06-26 14:02:46,118 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,118 - sqlalchemy.engine.Engine - INFO - [cached since 0.06081s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '2009', '9236633', '', 38.0086669921875, -122.54923248291016, None, None, 1, None, 0, None, '2009')
2025-06-26 14:02:46,121 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,122 - sqlalchemy.engine.Engine - INFO - [cached since 0.06453s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '2010', '9236810', '', 37.97053146362305, -122.52134704589844, None, None, 2, None, 0, None, '2010')
2025-06-26 14:02:46,124 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,125 - sqlalchemy.engine.Engine - INFO - [cached since 0.06759s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '2011', '9237096', '', 37.87248229980469, -122.51165008544922, None, None, 1, None, 0, None, '2011')
2025-06-26 14:02:46,127 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,128 - sqlalchemy.engine.Engine - INFO - [cached since 0.07026s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '2401', '9236704', '', 37.96763229370117, -122.5018310546875, None, None, 2, None, 0, None, '2401')
2025-06-26 14:02:46,130 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,130 - sqlalchemy.engine.Engine - INFO - [cached since 0.07277s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '2402', '9236695', '', 37.98271560668945, -122.56964874267578, None, None, 2, None, 0, None, '2402')
2025-06-26 14:02:46,132 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,133 - sqlalchemy.engine.Engine - INFO - [cached since 0.0752s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '2404', '9236641', '', 37.970767974853516, -122.51885223388672, None, None, 2, None, 0, None, '2404')
2025-06-26 14:02:46,136 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,136 - sqlalchemy.engine.Engine - INFO - [cached since 0.07882s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '2405', '9236845', '', 37.95658493041992, -122.50901794433594, None, None, 2, None, 0, None, '2405')
2025-06-26 14:02:46,139 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,140 - sqlalchemy.engine.Engine - INFO - [cached since 0.08219s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '2406', '9236574', '', 37.972232818603516, -122.52076721191406, None, None, 2, None, 0, None, '2406')
2025-06-26 14:02:46,142 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:02:46,142 - sqlalchemy.engine.Engine - INFO - [cached since 0.08473s ago] (datetime.datetime(2025, 6, 26, 14, 2, 30), '961', '9236905', '101', 38.43880081176758, -122.71361541748047, None, None, 1, None, 0, None, '961')
2025-06-26 14:02:46,144 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-26 14:02:46,147 - __main__ - INFO - Processed GTFS-RT for GG: 27 vehicles updated, 0 new vehicles added.
2025-06-26 14:02:46,148 - __main__ - INFO - Processing cycle completed in 0.59 seconds.
2025-06-26 14:02:46,149 - __main__ - INFO - Sleeping for 29 seconds...
2025-06-26 14:03:06,295 - __main__ - INFO - GTFS-RT processor stopped by user.
2025-06-26 14:03:06,295 - __main__ - INFO - GTFS-RT processor stopped.
2025-06-26 14:05:35,398 - __main__ - INFO - Starting GTFS-RT processor...
2025-06-26 14:05:35,399 - __main__ - INFO - Testing database connection...
2025-06-26 14:05:35,608 - databases - INFO - Connected to database postgresql+asyncpg://user:********@localhost:5432/transitpulse_db
2025-06-26 14:05:35,619 - databases - INFO - Disconnected from database postgresql+asyncpg://user:********@localhost:5432/transitpulse_db
2025-06-26 14:05:35,620 - __main__ - INFO - Database connection test passed!
2025-06-26 14:05:35,620 - __main__ - INFO - Starting continuous GTFS-RT processing loop...
2025-06-26 14:05:35,622 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 14:05:36,035 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 14:05:36,081 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-06-26 14:05:36,081 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 14:05:36,089 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-06-26 14:05:36,089 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 14:05:36,094 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-06-26 14:05:36,094 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 14:05:36,099 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 14:05:36,104 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,105 - sqlalchemy.engine.Engine - INFO - [generated in 0.00091s] (datetime.datetime(2025, 6, 26, 14, 5, 20), '1902', '9236970', '150', 37.87241744995117, -122.5077133178711, None, None, 2, None, 1, None, '1902')
2025-06-26 14:05:36,111 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,112 - sqlalchemy.engine.Engine - INFO - [cached since 0.008392s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '1904', '9236752', '130', 37.85868453979492, -122.4836654663086, None, None, 2, None, 1, None, '1904')
2025-06-26 14:05:36,116 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,116 - sqlalchemy.engine.Engine - INFO - [cached since 0.01238s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '1905', '9236770', '130', 37.79971694946289, -122.44631958007812, None, None, 2, None, 1, None, '1905')
2025-06-26 14:05:36,119 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,119 - sqlalchemy.engine.Engine - INFO - [cached since 0.0157s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '1909', '9236903', '101', 37.78105163574219, -122.41991424560547, None, None, 2, None, 1, None, '1909')
2025-06-26 14:05:36,122 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,123 - sqlalchemy.engine.Engine - INFO - [cached since 0.01932s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '1921', '9236887', '101', 37.8044319152832, -122.47205352783203, None, None, 2, None, 2, None, '1921')
2025-06-26 14:05:36,126 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,127 - sqlalchemy.engine.Engine - INFO - [cached since 0.02278s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '1922', '9237164', '114', 37.78163146972656, -122.39706420898438, None, None, 1, None, 1, None, '1922')
2025-06-26 14:05:36,130 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,131 - sqlalchemy.engine.Engine - INFO - [cached since 0.02688s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '1923', '9236906', '101', 38.471466064453125, -122.74051666259766, None, None, 1, None, 1, None, '1923')
2025-06-26 14:05:36,134 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,135 - sqlalchemy.engine.Engine - INFO - [cached since 0.03128s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '1930', '9236904', '101', 38.10625076293945, -122.57066345214844, None, None, 1, None, 1, None, '1930')
2025-06-26 14:05:36,139 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,139 - sqlalchemy.engine.Engine - INFO - [cached since 0.03565s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '1934', '9236954', '150', 37.78233337402344, -122.40711975097656, None, None, 1, None, 1, None, '1934')
2025-06-26 14:05:36,142 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,142 - sqlalchemy.engine.Engine - INFO - [cached since 0.03848s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '1941', '9236528', '580', 37.929317474365234, -122.38584899902344, None, None, 2, None, 1, None, '1941')
2025-06-26 14:05:36,144 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,145 - sqlalchemy.engine.Engine - INFO - [cached since 0.0414s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '1946', '9236886', '101', 38.23661804199219, -122.63646697998047, None, None, 1, None, 1, None, '1946')
2025-06-26 14:05:36,148 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,149 - sqlalchemy.engine.Engine - INFO - [cached since 0.04521s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '1950', '9236508', '580', 37.93418502807617, -122.4321517944336, None, None, 2, None, 1, None, '1950')
2025-06-26 14:05:36,151 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,152 - sqlalchemy.engine.Engine - INFO - [cached since 0.04819s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '2001', '9236595', '', 37.97024917602539, -122.51924896240234, None, None, 2, None, 0, None, '2001')
2025-06-26 14:05:36,155 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,155 - sqlalchemy.engine.Engine - INFO - [cached since 0.05161s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '2002', '9237119', '', 37.96631622314453, -122.51609802246094, None, None, 1, None, 0, None, '2002')
2025-06-26 14:05:36,158 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,158 - sqlalchemy.engine.Engine - INFO - [cached since 0.05437s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '2005', '9237131', '', 37.96328353881836, -122.51118469238281, None, None, 2, None, 0, None, '2005')
2025-06-26 14:05:36,161 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,162 - sqlalchemy.engine.Engine - INFO - [cached since 0.05844s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '2006', '9236825', '', 38.111717224121094, -122.56880187988281, None, None, 2, None, 0, None, '2006')
2025-06-26 14:05:36,165 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,165 - sqlalchemy.engine.Engine - INFO - [cached since 0.06119s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '2008', '9236786', '', 37.87241744995117, -122.5058364868164, None, None, 2, None, 0, None, '2008')
2025-06-26 14:05:36,167 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,167 - sqlalchemy.engine.Engine - INFO - [cached since 0.06345s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '2009', '9236633', '', 38.00870132446289, -122.54923248291016, None, None, 1, None, 0, None, '2009')
2025-06-26 14:05:36,170 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,170 - sqlalchemy.engine.Engine - INFO - [cached since 0.06625s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '2010', '9236810', '', 37.98606491088867, -122.52465057373047, None, None, 2, None, 0, None, '2010')
2025-06-26 14:05:36,173 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,173 - sqlalchemy.engine.Engine - INFO - [cached since 0.06959s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '2011', '9237096', '', 37.872467041015625, -122.51166534423828, None, None, 1, None, 0, None, '2011')
2025-06-26 14:05:36,176 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,177 - sqlalchemy.engine.Engine - INFO - [cached since 0.07311s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '2401', '9236704', '', 37.964534759521484, -122.50888061523438, None, None, 1, None, 0, None, '2401')
2025-06-26 14:05:36,179 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,180 - sqlalchemy.engine.Engine - INFO - [cached since 0.07584s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '2402', '9236695', '', 37.976566314697266, -122.5628662109375, None, None, 1, None, 0, None, '2402')
2025-06-26 14:05:36,182 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,183 - sqlalchemy.engine.Engine - INFO - [cached since 0.07882s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '2404', '9236641', '', 37.97141647338867, -122.52214813232422, None, None, 2, None, 0, None, '2404')
2025-06-26 14:05:36,185 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,186 - sqlalchemy.engine.Engine - INFO - [cached since 0.08224s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '2405', '9236845', '', 37.931331634521484, -122.51615142822266, None, None, 2, None, 0, None, '2405')
2025-06-26 14:05:36,190 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,191 - sqlalchemy.engine.Engine - INFO - [cached since 0.08703s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '2406', '9236574', '', 37.972618103027344, -122.52335357666016, None, None, 2, None, 0, None, '2406')
2025-06-26 14:05:36,194 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:05:36,195 - sqlalchemy.engine.Engine - INFO - [cached since 0.09107s ago] (datetime.datetime(2025, 6, 26, 14, 5, 20), '961', '9236905', '101', 38.43788146972656, -122.71745300292969, None, None, 2, None, 1, None, '961')
2025-06-26 14:05:36,196 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-26 14:05:36,199 - __main__ - INFO - Processed GTFS-RT for GG: 26 vehicles updated, 0 new vehicles added.
2025-06-26 14:05:36,200 - __main__ - INFO - Processing cycle completed in 0.58 seconds.
2025-06-26 14:05:36,200 - __main__ - INFO - Sleeping for 29 seconds...
2025-06-26 14:05:44,771 - __main__ - INFO - GTFS-RT processor stopped by user.
2025-06-26 14:05:44,772 - __main__ - INFO - GTFS-RT processor stopped.
2025-06-26 14:12:16,375 - __main__ - INFO - Starting GTFS-RT processor...
2025-06-26 14:12:16,376 - __main__ - INFO - Testing database connection...
2025-06-26 14:12:16,595 - databases - INFO - Connected to database postgresql+asyncpg://user:********@localhost:5432/transitpulse_db
2025-06-26 14:12:16,612 - databases - INFO - Disconnected from database postgresql+asyncpg://user:********@localhost:5432/transitpulse_db
2025-06-26 14:12:16,612 - __main__ - INFO - Database connection test passed!
2025-06-26 14:12:16,612 - __main__ - INFO - Starting continuous GTFS-RT processing loop...
2025-06-26 14:12:16,613 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 14:12:17,002 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 14:12:17,053 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-06-26 14:12:17,053 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 14:12:17,057 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-06-26 14:12:17,057 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 14:12:17,060 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-06-26 14:12:17,060 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 14:12:17,064 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 14:12:17,066 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,067 - sqlalchemy.engine.Engine - INFO - [generated in 0.00084s] (datetime.datetime(2025, 6, 26, 14, 12, 10), '1902', '9236970', '150', 37.809532165527344, -122.47743225097656, None, None, 2, None, 1, None, '1902')
2025-06-26 14:12:17,073 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,074 - sqlalchemy.engine.Engine - INFO - [cached since 0.007399s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '1904', '9236752', '130', 37.87226486206055, -122.50511932373047, None, None, 2, None, 1, None, '1904')
2025-06-26 14:12:17,076 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,077 - sqlalchemy.engine.Engine - INFO - [cached since 0.01043s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '1905', '9236770', '130', 37.800567626953125, -122.42446899414062, None, None, 2, None, 1, None, '1905')
2025-06-26 14:12:17,080 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,081 - sqlalchemy.engine.Engine - INFO - [cached since 0.01435s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '1909', '9236903', '101', 37.77778244018555, -122.41339874267578, None, None, 2, None, 1, None, '1909')
2025-06-26 14:12:17,085 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,086 - sqlalchemy.engine.Engine - INFO - [cached since 0.01946s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '1921', '9236887', '101', 37.852149963378906, -122.49130249023438, None, None, 2, None, 2, None, '1921')
2025-06-26 14:12:17,089 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,089 - sqlalchemy.engine.Engine - INFO - [cached since 0.02307s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '1922', '9237164', '114', 37.78163146972656, -122.39706420898438, None, None, 1, None, 1, None, '1922')
2025-06-26 14:12:17,092 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,092 - sqlalchemy.engine.Engine - INFO - [cached since 0.02616s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '1923', '9236906', '101', 38.471466064453125, -122.74051666259766, None, None, 1, None, 1, None, '1923')
2025-06-26 14:12:17,095 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,096 - sqlalchemy.engine.Engine - INFO - [cached since 0.02991s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '1930', '9236904', '101', 38.070682525634766, -122.53938293457031, None, None, 2, None, 1, None, '1930')
2025-06-26 14:12:17,099 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,100 - sqlalchemy.engine.Engine - INFO - [cached since 0.03401s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '1934', '9236954', '150', 37.78010177612305, -122.41691589355469, None, None, 2, None, 1, None, '1934')
2025-06-26 14:12:17,103 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,104 - sqlalchemy.engine.Engine - INFO - [cached since 0.03749s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '1941', '9236528', '580', 37.92959976196289, -122.38436889648438, None, None, 2, None, 1, None, '1941')
2025-06-26 14:12:17,106 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,106 - sqlalchemy.engine.Engine - INFO - [cached since 0.04022s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '1946', '9236886', '101', 38.24323272705078, -122.63126373291016, None, None, 2, None, 1, None, '1946')
2025-06-26 14:12:17,109 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,109 - sqlalchemy.engine.Engine - INFO - [cached since 0.04316s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '1950', '9236508', '580', 37.9254150390625, -122.36415100097656, None, None, 2, None, 1, None, '1950')
2025-06-26 14:12:17,111 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,112 - sqlalchemy.engine.Engine - INFO - [cached since 0.04592s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '2001', '9236575', '', 37.964332580566406, -122.50135040283203, None, None, 1, None, 0, None, '2001')
2025-06-26 14:12:17,117 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,117 - sqlalchemy.engine.Engine - INFO - [cached since 0.05117s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '2002', '9237119', '', 37.97071838378906, -122.52243041992188, None, None, 1, None, 0, None, '2002')
2025-06-26 14:12:17,119 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,120 - sqlalchemy.engine.Engine - INFO - [cached since 0.05359s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '2003', '9236787', '', 37.87234878540039, -122.5116195678711, None, None, 1, None, 0, None, '2003')
2025-06-26 14:12:17,121 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,122 - sqlalchemy.engine.Engine - INFO - [cached since 0.05577s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '2005', '9237131', '', 37.971134185791016, -122.52246856689453, None, None, 1, None, 0, None, '2005')
2025-06-26 14:12:17,124 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,125 - sqlalchemy.engine.Engine - INFO - [cached since 0.05847s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '2006', '9236825', '', 38.10151672363281, -122.5618667602539, None, None, 2, None, 0, None, '2006')
2025-06-26 14:12:17,127 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,127 - sqlalchemy.engine.Engine - INFO - [cached since 0.06118s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '2008', '9236786', '', 37.926918029785156, -122.51480102539062, None, None, 2, None, 0, None, '2008')
2025-06-26 14:12:17,131 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,131 - sqlalchemy.engine.Engine - INFO - [cached since 0.06497s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '2009', '9236633', '', 37.99800109863281, -122.53314971923828, None, None, 2, None, 0, None, '2009')
2025-06-26 14:12:17,133 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,134 - sqlalchemy.engine.Engine - INFO - [cached since 0.06767s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '2010', '9236810', '', 38.03241729736328, -122.5369644165039, None, None, 2, None, 0, None, '2010')
2025-06-26 14:12:17,136 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,137 - sqlalchemy.engine.Engine - INFO - [cached since 0.07062s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '2011', '9237096', '', 37.87329864501953, -122.51180267333984, None, None, 2, None, 0, None, '2011')
2025-06-26 14:12:17,140 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,140 - sqlalchemy.engine.Engine - INFO - [cached since 0.07397s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '2401', '9236704', '', 37.971065521240234, -122.52281951904297, None, None, 1, None, 0, None, '2401')
2025-06-26 14:12:17,143 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,144 - sqlalchemy.engine.Engine - INFO - [cached since 0.07772s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '2402', '9236695', '', 37.9747314453125, -122.5433349609375, None, None, 2, None, 0, None, '2402')
2025-06-26 14:12:17,147 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,148 - sqlalchemy.engine.Engine - INFO - [cached since 0.08198s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '2404', '9236618', '', 37.97098159790039, -122.52336883544922, None, None, 2, None, 0, None, '2404')
2025-06-26 14:12:17,151 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,151 - sqlalchemy.engine.Engine - INFO - [cached since 0.08523s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '2405', '9236845', '', 37.87956619262695, -122.51608276367188, None, None, 2, None, 0, None, '2405')
2025-06-26 14:12:17,154 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,155 - sqlalchemy.engine.Engine - INFO - [cached since 0.08845s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '2406', '9236574', '', 37.98765182495117, -122.5275650024414, None, None, 2, None, 0, None, '2406')
2025-06-26 14:12:17,157 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,157 - sqlalchemy.engine.Engine - INFO - [cached since 0.09099s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '961', '9236905', '101', 38.35879898071289, -122.71324920654297, None, None, 2, None, 1, None, '961')
2025-06-26 14:12:17,159 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:12:17,159 - sqlalchemy.engine.Engine - INFO - [cached since 0.09313s ago] (datetime.datetime(2025, 6, 26, 14, 12, 10), '975', '9236487', '172', 37.78631591796875, -122.39583587646484, None, None, 2, None, 1, None, '975')
2025-06-26 14:12:17,163 - sqlalchemy.engine.Engine - INFO - INSERT INTO live_vehicle_positions (timestamp, vehicle_id, trip_id, route_id, latitude, longitude, bearing, speed, current_status, congestion_level, occupancy_status, stop_id) VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::FLOAT, $7::FLOAT, $8::FLOAT, $9::INTEGER, $10::INTEGER, $11::INTEGER, $12::VARCHAR) RETURNING live_vehicle_positions.id
2025-06-26 14:12:17,164 - sqlalchemy.engine.Engine - INFO - [generated in 0.00080s] (datetime.datetime(2025, 6, 26, 14, 12, 10), '975', '9236487', '172', 37.78631591796875, -122.39583587646484, None, None, 2, None, 1, None)
2025-06-26 14:12:17,168 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-26 14:12:17,172 - __main__ - INFO - Processed GTFS-RT for GG: 27 vehicles updated, 1 new vehicles added.
2025-06-26 14:12:17,173 - __main__ - INFO - Processing cycle completed in 0.56 seconds.
2025-06-26 14:12:17,173 - __main__ - INFO - Sleeping for 29 seconds...
2025-06-26 14:12:20,989 - __main__ - INFO - GTFS-RT processor stopped by user.
2025-06-26 14:12:20,990 - __main__ - INFO - GTFS-RT processor stopped.
2025-06-26 14:15:10,765 - __main__ - INFO - Starting GTFS-RT processor...
2025-06-26 14:15:10,767 - __main__ - INFO - Testing database connection...
2025-06-26 14:15:11,031 - databases - INFO - Connected to database postgresql+asyncpg://user:********@localhost:5432/transitpulse_db
2025-06-26 14:15:11,046 - databases - INFO - Disconnected from database postgresql+asyncpg://user:********@localhost:5432/transitpulse_db
2025-06-26 14:15:11,046 - __main__ - INFO - Database connection test passed!
2025-06-26 14:15:11,046 - __main__ - INFO - Starting continuous GTFS-RT processing loop...
2025-06-26 14:15:11,047 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 14:15:11,450 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 14:15:11,517 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-06-26 14:15:11,518 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 14:15:11,525 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-06-26 14:15:11,525 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 14:15:11,533 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-06-26 14:15:11,533 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 14:15:11,537 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 14:15:11,545 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,545 - sqlalchemy.engine.Engine - INFO - [generated in 0.00089s] (datetime.datetime(2025, 6, 26, 14, 15, 10), '1902', '9236970', '150', 37.80021667480469, -122.44703674316406, None, None, 2, None, 1, None, '1902')
2025-06-26 14:15:11,554 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,555 - sqlalchemy.engine.Engine - INFO - [cached since 0.009941s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '1904', '9236752', '130', 37.872249603271484, -122.51156616210938, None, None, 1, None, 1, None, '1904')
2025-06-26 14:15:11,559 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,560 - sqlalchemy.engine.Engine - INFO - [cached since 0.01504s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '1905', '9236770', '130', 37.7958984375, -122.42346954345703, None, None, 2, None, 1, None, '1905')
2025-06-26 14:15:11,563 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,564 - sqlalchemy.engine.Engine - INFO - [cached since 0.01944s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '1906', '9236753', '130', 37.78463363647461, -122.40399932861328, None, None, 2, None, 0, None, '1906')
2025-06-26 14:15:11,568 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,568 - sqlalchemy.engine.Engine - INFO - [cached since 0.02366s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '1909', '9236903', '101', 37.78255081176758, -122.40658569335938, None, None, 1, None, 1, None, '1909')
2025-06-26 14:15:11,572 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,573 - sqlalchemy.engine.Engine - INFO - [cached since 0.02804s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '1921', '9236887', '101', 37.89011764526367, -122.51661682128906, None, None, 2, None, 2, None, '1921')
2025-06-26 14:15:11,576 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,578 - sqlalchemy.engine.Engine - INFO - [cached since 0.03303s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '1922', '9237164', '114', 37.78163146972656, -122.39706420898438, None, None, 1, None, 1, None, '1922')
2025-06-26 14:15:11,582 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,583 - sqlalchemy.engine.Engine - INFO - [cached since 0.03833s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '1923', '9236906', '101', 38.471466064453125, -122.74051666259766, None, None, 1, None, 1, None, '1923')
2025-06-26 14:15:11,586 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,587 - sqlalchemy.engine.Engine - INFO - [cached since 0.04271s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '1930', '9236904', '101', 38.02443313598633, -122.53846740722656, None, None, 2, None, 1, None, '1930')
2025-06-26 14:15:11,591 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,591 - sqlalchemy.engine.Engine - INFO - [cached since 0.04674s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '1934', '9236954', '150', 37.783451080322266, -122.42091369628906, None, None, 2, None, 1, None, '1934')
2025-06-26 14:15:11,595 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,595 - sqlalchemy.engine.Engine - INFO - [cached since 0.05076s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '1941', '9236528', '580', 37.92945098876953, -122.38668060302734, None, None, 2, None, 1, None, '1941')
2025-06-26 14:15:11,599 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,600 - sqlalchemy.engine.Engine - INFO - [cached since 0.05493s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '1946', '9236886', '101', 38.249267578125, -122.63213348388672, None, None, 2, None, 1, None, '1946')
2025-06-26 14:15:11,602 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,603 - sqlalchemy.engine.Engine - INFO - [cached since 0.05806s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '1950', '9236508', '580', 37.92511749267578, -122.35546875, None, None, 2, None, 1, None, '1950')
2025-06-26 14:15:11,605 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,605 - sqlalchemy.engine.Engine - INFO - [cached since 0.06087s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '2001', '9236575', '', 37.966835021972656, -122.50363159179688, None, None, 1, None, 0, None, '2001')
2025-06-26 14:15:11,609 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,610 - sqlalchemy.engine.Engine - INFO - [cached since 0.0652s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '2002', '9237119', '', 37.970733642578125, -122.52245330810547, None, None, 1, None, 0, None, '2002')
2025-06-26 14:15:11,612 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,613 - sqlalchemy.engine.Engine - INFO - [cached since 0.06845s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '2003', '9236787', '', 37.87263488769531, -122.51171875, None, None, 1, None, 0, None, '2003')
2025-06-26 14:15:11,615 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,616 - sqlalchemy.engine.Engine - INFO - [cached since 0.07132s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '2005', '9237131', '', 37.97129821777344, -122.52245330810547, None, None, 2, None, 0, None, '2005')
2025-06-26 14:15:11,618 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,619 - sqlalchemy.engine.Engine - INFO - [cached since 0.07442s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '2006', '9236825', '', 38.0890007019043, -122.55613708496094, None, None, 2, None, 0, None, '2006')
2025-06-26 14:15:11,621 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,622 - sqlalchemy.engine.Engine - INFO - [cached since 0.07703s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '2008', '9236786', '', 37.94423294067383, -122.51445007324219, None, None, 2, None, 0, None, '2008')
2025-06-26 14:15:11,625 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,627 - sqlalchemy.engine.Engine - INFO - [cached since 0.08228s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '2009', '9236633', '', 37.99528503417969, -122.53399658203125, None, None, 2, None, 0, None, '2009')
2025-06-26 14:15:11,631 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,631 - sqlalchemy.engine.Engine - INFO - [cached since 0.08683s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '2010', '9236810', '', 38.063148498535156, -122.5343017578125, None, None, 2, None, 0, None, '2010')
2025-06-26 14:15:11,635 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,636 - sqlalchemy.engine.Engine - INFO - [cached since 0.09105s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '2011', '9237096', '', 37.87216567993164, -122.50613403320312, None, None, 2, None, 0, None, '2011')
2025-06-26 14:15:11,638 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,639 - sqlalchemy.engine.Engine - INFO - [cached since 0.09456s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '2401', '9236704', '', 37.97105026245117, -122.52279663085938, None, None, 1, None, 0, None, '2401')
2025-06-26 14:15:11,643 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,644 - sqlalchemy.engine.Engine - INFO - [cached since 0.09923s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '2402', '9236695', '', 37.973915100097656, -122.53601837158203, None, None, 2, None, 0, None, '2402')
2025-06-26 14:15:11,647 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,648 - sqlalchemy.engine.Engine - INFO - [cached since 0.1038s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '2404', '9236618', '', 37.96876525878906, -122.51947021484375, None, None, 2, None, 0, None, '2404')
2025-06-26 14:15:11,652 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,652 - sqlalchemy.engine.Engine - INFO - [cached since 0.1077s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '2405', '9237097', '', 37.87248229980469, -122.51168060302734, None, None, 1, None, 0, None, '2405')
2025-06-26 14:15:11,655 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,656 - sqlalchemy.engine.Engine - INFO - [cached since 0.1111s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '2406', '9236574', '', 37.99658203125, -122.528564453125, None, None, 2, None, 0, None, '2406')
2025-06-26 14:15:11,660 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,661 - sqlalchemy.engine.Engine - INFO - [cached since 0.1162s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '961', '9236905', '101', 38.34718322753906, -122.709716796875, None, None, 1, None, 1, None, '961')
2025-06-26 14:15:11,664 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:15:11,665 - sqlalchemy.engine.Engine - INFO - [cached since 0.1208s ago] (datetime.datetime(2025, 6, 26, 14, 15, 10), '975', '9236487', '172', 37.78911590576172, -122.39488220214844, None, None, 2, None, 1, None, '975')
2025-06-26 14:15:11,668 - sqlalchemy.engine.Engine - INFO - INSERT INTO live_vehicle_positions (timestamp, vehicle_id, trip_id, route_id, latitude, longitude, bearing, speed, current_status, congestion_level, occupancy_status, stop_id) VALUES ($1::TIMESTAMP WITHOUT TIME ZONE, $2::VARCHAR, $3::VARCHAR, $4::VARCHAR, $5::FLOAT, $6::FLOAT, $7::FLOAT, $8::FLOAT, $9::INTEGER, $10::INTEGER, $11::INTEGER, $12::VARCHAR) RETURNING live_vehicle_positions.id
2025-06-26 14:15:11,669 - sqlalchemy.engine.Engine - INFO - [generated in 0.00066s] (datetime.datetime(2025, 6, 26, 14, 15, 10), '1906', '9236753', '130', 37.78463363647461, -122.40399932861328, None, None, 2, None, 0, None)
2025-06-26 14:15:11,673 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-26 14:15:11,680 - __main__ - INFO - Processed GTFS-RT for GG: 28 vehicles updated, 1 new vehicles added.
2025-06-26 14:15:11,681 - __main__ - INFO - Processing cycle completed in 0.63 seconds.
2025-06-26 14:15:11,681 - __main__ - INFO - Sleeping for 29 seconds...
2025-06-26 14:15:17,368 - __main__ - INFO - GTFS-RT processor stopped by user.
2025-06-26 14:15:17,369 - __main__ - INFO - GTFS-RT processor stopped.
2025-06-26 14:46:16,089 - __main__ - INFO - Starting GTFS-RT processor...
2025-06-26 14:46:16,090 - __main__ - INFO - Testing database connection...
2025-06-26 14:46:16,296 - databases - INFO - Connected to database postgresql+asyncpg://user:********@localhost:5432/transitpulse_db
2025-06-26 14:46:16,313 - databases - INFO - Disconnected from database postgresql+asyncpg://user:********@localhost:5432/transitpulse_db
2025-06-26 14:46:16,313 - __main__ - INFO - Database connection test passed!
2025-06-26 14:46:16,314 - __main__ - INFO - Starting continuous GTFS-RT processing loop...
2025-06-26 14:46:16,314 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 14:46:17,182 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 14:46:17,235 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-06-26 14:46:17,236 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 14:46:17,241 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-06-26 14:46:17,242 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 14:46:17,247 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-06-26 14:46:17,248 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 14:46:17,252 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 14:46:17,254 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,254 - sqlalchemy.engine.Engine - INFO - [generated in 0.00064s] (datetime.datetime(2025, 6, 26, 14, 46, 10), '1801', '9236720', '', 37.97398376464844, -122.5371322631836, None, None, 2, None, 0, None, '1801')
2025-06-26 14:46:17,262 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,262 - sqlalchemy.engine.Engine - INFO - [cached since 0.008881s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '1906', '9236753', '130', 37.801666259765625, -122.46212005615234, None, None, 2, None, 2, None, '1906')
2025-06-26 14:46:17,265 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,265 - sqlalchemy.engine.Engine - INFO - [cached since 0.01154s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '1907', '9236927', '132', 37.78201675415039, -122.3965835571289, None, None, 1, None, 1, None, '1907')
2025-06-26 14:46:17,267 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,268 - sqlalchemy.engine.Engine - INFO - [cached since 0.01426s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '1921', '9236887', '101', 38.105464935302734, -122.56500244140625, None, None, 2, None, 1, None, '1921')
2025-06-26 14:46:17,270 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,271 - sqlalchemy.engine.Engine - INFO - [cached since 0.01736s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '1922', '9237164', '114', 37.78158187866211, -122.39689636230469, None, None, 1, None, 1, None, '1922')
2025-06-26 14:46:17,274 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,274 - sqlalchemy.engine.Engine - INFO - [cached since 0.02064s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '1923', '9236906', '101', 38.471466064453125, -122.74051666259766, None, None, 1, None, 1, None, '1923')
2025-06-26 14:46:17,277 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,277 - sqlalchemy.engine.Engine - INFO - [cached since 0.02359s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '1930', '9236904', '101', 37.8123664855957, -122.47776794433594, None, None, 2, None, 2, None, '1930')
2025-06-26 14:46:17,279 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,279 - sqlalchemy.engine.Engine - INFO - [cached since 0.02583s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '1934', '9236954', '150', 37.85966491699219, -122.500732421875, None, None, 2, None, 1, None, '1934')
2025-06-26 14:46:17,281 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,282 - sqlalchemy.engine.Engine - INFO - [cached since 0.02884s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '1941', '9236509', '580', 37.97060012817383, -122.52306365966797, None, None, 2, None, 1, None, '1941')
2025-06-26 14:46:17,285 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,286 - sqlalchemy.engine.Engine - INFO - [cached since 0.03275s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '1946', '9236907', '101', 38.47145080566406, -122.74044799804688, None, None, 1, None, 1, None, '1946')
2025-06-26 14:46:17,289 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,290 - sqlalchemy.engine.Engine - INFO - [cached since 0.03624s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '1947', '9236888', '101', 37.78013229370117, -122.42005157470703, None, None, 2, None, 1, None, '1947')
2025-06-26 14:46:17,291 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,292 - sqlalchemy.engine.Engine - INFO - [cached since 0.03819s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '1950', '9236522', '580', 37.929901123046875, -122.38455200195312, None, None, 2, None, 0, None, '1950')
2025-06-26 14:46:17,293 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,294 - sqlalchemy.engine.Engine - INFO - [cached since 0.04054s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '1952', '9236771', '130', 37.857200622558594, -122.4809341430664, None, None, 2, None, 1, None, '1952')
2025-06-26 14:46:17,296 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,296 - sqlalchemy.engine.Engine - INFO - [cached since 0.04264s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '2001', '9236575', '', 37.9967155456543, -122.52843475341797, None, None, 2, None, 0, None, '2001')
2025-06-26 14:46:17,298 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,298 - sqlalchemy.engine.Engine - INFO - [cached since 0.04489s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '2003', '9236787', '', 37.952598571777344, -122.50885009765625, None, None, 2, None, 0, None, '2003')
2025-06-26 14:46:17,300 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,300 - sqlalchemy.engine.Engine - INFO - [cached since 0.04694s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '2004', '9236715', '', 37.976383209228516, -122.56188201904297, None, None, 2, None, 0, None, '2004')
2025-06-26 14:46:17,303 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,303 - sqlalchemy.engine.Engine - INFO - [cached since 0.04982s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '2005', '9237120', '', 37.969383239746094, -122.5217514038086, None, None, 2, None, 0, None, '2005')
2025-06-26 14:46:17,306 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,307 - sqlalchemy.engine.Engine - INFO - [cached since 0.05324s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '2006', '9236825', '', 37.887718200683594, -122.51691436767578, None, None, 2, None, 0, None, '2006')
2025-06-26 14:46:17,309 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,310 - sqlalchemy.engine.Engine - INFO - [cached since 0.05611s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '2008', '9236786', '', 38.06633377075195, -122.53666687011719, None, None, 2, None, 0, None, '2008')
2025-06-26 14:46:17,312 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,312 - sqlalchemy.engine.Engine - INFO - [cached since 0.05885s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '2009', '9236576', '', 37.96456527709961, -122.50891876220703, None, None, 1, None, 0, None, '2009')
2025-06-26 14:46:17,314 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,315 - sqlalchemy.engine.Engine - INFO - [cached since 0.06112s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '2010', '9236796', '', 38.09064865112305, -122.55886840820312, None, None, 2, None, 0, None, '2010')
2025-06-26 14:46:17,317 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,318 - sqlalchemy.engine.Engine - INFO - [cached since 0.06404s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '2011', '9237096', '', 37.971282958984375, -122.52246856689453, None, None, 1, None, 0, None, '2011')
2025-06-26 14:46:17,320 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,321 - sqlalchemy.engine.Engine - INFO - [cached since 0.06702s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '2401', '9236696', '', 38.0002326965332, -122.60421752929688, None, None, 1, None, 0, None, '2401')
2025-06-26 14:46:17,323 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,324 - sqlalchemy.engine.Engine - INFO - [cached since 0.07003s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '2402', '9236705', '', 37.95298385620117, -122.49088287353516, None, None, 1, None, 0, None, '2402')
2025-06-26 14:46:17,325 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,326 - sqlalchemy.engine.Engine - INFO - [cached since 0.07217s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '2404', '9236632', '', 37.970584869384766, -122.52266693115234, None, None, 2, None, 0, None, '2404')
2025-06-26 14:46:17,328 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,329 - sqlalchemy.engine.Engine - INFO - [cached since 0.07501s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '2405', '9237097', '', 37.882118225097656, -122.51646423339844, None, None, 2, None, 0, None, '2405')
2025-06-26 14:46:17,331 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,332 - sqlalchemy.engine.Engine - INFO - [cached since 0.07822s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '2406', '9236593', '', 37.99831771850586, -122.53099822998047, None, None, 2, None, 0, None, '2406')
2025-06-26 14:46:17,335 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,336 - sqlalchemy.engine.Engine - INFO - [cached since 0.08218s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '960', '9236955', '150', 0.0, 0.0, None, None, 1, None, 1, None, '960')
2025-06-26 14:46:17,337 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,338 - sqlalchemy.engine.Engine - INFO - [cached since 0.08442s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '961', '9236905', '101', 38.228065490722656, -122.62571716308594, None, None, 2, None, 1, None, '961')
2025-06-26 14:46:17,340 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,340 - sqlalchemy.engine.Engine - INFO - [cached since 0.0868s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '974', '9236925', '101', 37.79010009765625, -122.39640045166016, None, None, 1, None, 1, None, '974')
2025-06-26 14:46:17,342 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:46:17,342 - sqlalchemy.engine.Engine - INFO - [cached since 0.08875s ago] (datetime.datetime(2025, 6, 26, 14, 46, 10), '975', '9236487', '172', 37.80348205566406, -122.45311737060547, None, None, 2, None, 1, None, '975')
2025-06-26 14:46:17,345 - sqlalchemy.engine.Engine - INFO - INSERT INTO live_vehicle_positions (timestamp, vehicle_id, trip_id, route_id, latitude, longitude, bearing, speed, current_status, congestion_level, occupancy_status, stop_id) SELECT p0::TIMESTAMP WITHOUT TIME ZONE, p1::VARCHAR, p2::VARCHAR, p3::VARC ... 1467 characters truncated ... ounter) ORDER BY sen_counter RETURNING live_vehicle_positions.id, live_vehicle_positions.id AS id__1
2025-06-26 14:46:17,345 - sqlalchemy.engine.Engine - INFO - [generated in 0.00009s (insertmanyvalues) 1/1 (ordered)] (datetime.datetime(2025, 6, 26, 14, 46, 10), '1801', '9236720', '', 37.97398376464844, -122.5371322631836, None, None, 2, None, 0, None, datetime.datetime(2025, 6, 26, 14, 46, 10), '1907', '9236927', '132', 37.78201675415039, -122.3965835571289, None, None, 1, None, 1, None, datetime.datetime(2025, 6, 26, 14, 46, 10), '1947', '9236888', '101', 37.78013229370117, -122.42005157470703, None, None, 2, None, 1, None, datetime.datetime(2025, 6, 26, 14, 46, 10), '1952', '9236771', '130', 37.857200622558594, -122.4809341430664, None, None, 2, None, 1, None, datetime.datetime(2025, 6, 26, 14, 46, 10), '2004', '9236715', '', 37.976383209228516, -122.56188201904297, None, None, 2, None, 0, None, datetime.datetime(2025, 6, 26, 14, 46, 10), '960', '9236955', '150', 0.0, 0.0, None, None, 1, None, 1, None, datetime.datetime(2025, 6, 26, 14, 46, 10), '974', '9236925', '101', 37.79010009765625, -122.39640045166016, None, None, 1, None, 1, None)
2025-06-26 14:46:17,349 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-26 14:46:17,353 - __main__ - INFO - Processed GTFS-RT for GG: 24 vehicles updated, 7 new vehicles added.
2025-06-26 14:46:17,354 - __main__ - INFO - Processing cycle completed in 1.04 seconds.
2025-06-26 14:46:17,354 - __main__ - INFO - Sleeping for 28 seconds...
2025-06-26 14:46:26,095 - __main__ - INFO - GTFS-RT processor stopped by user.
2025-06-26 14:46:26,096 - __main__ - INFO - GTFS-RT processor stopped.
2025-06-26 14:49:01,173 - __main__ - INFO - Starting GTFS-RT processor...
2025-06-26 14:49:01,174 - __main__ - INFO - Testing database connection...
2025-06-26 14:49:01,380 - databases - INFO - Connected to database postgresql+asyncpg://user:********@localhost:5432/transitpulse_db
2025-06-26 14:49:01,423 - databases - INFO - Disconnected from database postgresql+asyncpg://user:********@localhost:5432/transitpulse_db
2025-06-26 14:49:01,424 - __main__ - INFO - Database connection test passed!
2025-06-26 14:49:01,424 - __main__ - INFO - Starting continuous GTFS-RT processing loop...
2025-06-26 14:49:01,425 - __main__ - INFO - Fetching real-time vehicle positions for GG from http://api.511.org/Transit/VehiclePositions...
2025-06-26 14:49:02,165 - httpx - INFO - HTTP Request: GET http://api.511.org/Transit/VehiclePositions?api_key=b43cedb9-b614-4739-bb3a-e3c07f895fab&agency=GG "HTTP/1.1 200 OK"
2025-06-26 14:49:02,217 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-06-26 14:49:02,218 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 14:49:02,222 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-06-26 14:49:02,222 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 14:49:02,225 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-06-26 14:49:02,226 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-06-26 14:49:02,228 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-06-26 14:49:02,232 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,233 - sqlalchemy.engine.Engine - INFO - [generated in 0.00056s] (datetime.datetime(2025, 6, 26, 14, 48, 50), '1801', '9236720', '', 37.97556686401367, -122.54776763916016, None, None, 2, None, 0, None, '1801')
2025-06-26 14:49:02,239 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,240 - sqlalchemy.engine.Engine - INFO - [cached since 0.007359s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '1906', '9236753', '130', 37.807315826416016, -122.47518157958984, None, None, 1, None, 2, None, '1906')
2025-06-26 14:49:02,242 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,243 - sqlalchemy.engine.Engine - INFO - [cached since 0.01055s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '1907', '9236927', '132', 37.78201675415039, -122.3965835571289, None, None, 1, None, 1, None, '1907')
2025-06-26 14:49:02,245 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,245 - sqlalchemy.engine.Engine - INFO - [cached since 0.01321s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '1921', '9236887', '101', 38.10653305053711, -122.57066345214844, None, None, 1, None, 1, None, '1921')
2025-06-26 14:49:02,248 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,248 - sqlalchemy.engine.Engine - INFO - [cached since 0.01614s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '1922', '9237164', '114', 37.78158187866211, -122.39689636230469, None, None, 1, None, 1, None, '1922')
2025-06-26 14:49:02,250 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,251 - sqlalchemy.engine.Engine - INFO - [cached since 0.01837s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '1923', '9236906', '101', 38.47196578979492, -122.73605346679688, None, None, 2, None, 1, None, '1923')
2025-06-26 14:49:02,253 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,255 - sqlalchemy.engine.Engine - INFO - [cached since 0.02235s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '1930', '9236904', '101', 37.80670166015625, -122.47541809082031, None, None, 1, None, 2, None, '1930')
2025-06-26 14:49:02,257 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,258 - sqlalchemy.engine.Engine - INFO - [cached since 0.02557s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '1934', '9236954', '150', 37.871700286865234, -122.50830078125, None, None, 2, None, 1, None, '1934')
2025-06-26 14:49:02,259 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,260 - sqlalchemy.engine.Engine - INFO - [cached since 0.02761s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '1941', '9236509', '580', 37.96039962768555, -122.51165008544922, None, None, 2, None, 1, None, '1941')
2025-06-26 14:49:02,262 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,262 - sqlalchemy.engine.Engine - INFO - [cached since 0.03001s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '1946', '9236907', '101', 38.47145080566406, -122.74044799804688, None, None, 1, None, 1, None, '1946')
2025-06-26 14:49:02,264 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,264 - sqlalchemy.engine.Engine - INFO - [cached since 0.0321s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '1947', '9236888', '101', 37.78558349609375, -122.42134857177734, None, None, 1, None, 1, None, '1947')
2025-06-26 14:49:02,266 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,266 - sqlalchemy.engine.Engine - INFO - [cached since 0.03399s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '1950', '9236522', '580', 37.92981719970703, -122.38488006591797, None, None, 2, None, 0, None, '1950')
2025-06-26 14:49:02,268 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,269 - sqlalchemy.engine.Engine - INFO - [cached since 0.03635s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '1952', '9236771', '130', 37.85333251953125, -122.4789810180664, None, None, 2, None, 1, None, '1952')
2025-06-26 14:49:02,271 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,272 - sqlalchemy.engine.Engine - INFO - [cached since 0.03977s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '2001', '9236575', '', 38.000633239746094, -122.53491973876953, None, None, 2, None, 0, None, '2001')
2025-06-26 14:49:02,274 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,275 - sqlalchemy.engine.Engine - INFO - [cached since 0.04245s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '2003', '9236787', '', 37.97053146362305, -122.52123260498047, None, None, 2, None, 0, None, '2003')
2025-06-26 14:49:02,276 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,277 - sqlalchemy.engine.Engine - INFO - [cached since 0.04442s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '2004', '9236715', '', 37.97650146484375, -122.55371856689453, None, None, 1, None, 0, None, '2004')
2025-06-26 14:49:02,278 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,279 - sqlalchemy.engine.Engine - INFO - [cached since 0.04668s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '2005', '9237120', '', 37.94721603393555, -122.51370239257812, None, None, 2, None, 0, None, '2005')
2025-06-26 14:49:02,281 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,281 - sqlalchemy.engine.Engine - INFO - [cached since 0.04894s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '2008', '9236786', '', 38.09001541137695, -122.55633544921875, None, None, 2, None, 0, None, '2008')
2025-06-26 14:49:02,283 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,283 - sqlalchemy.engine.Engine - INFO - [cached since 0.05089s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '2009', '9236576', '', 37.96726608276367, -122.51773071289062, None, None, 2, None, 0, None, '2009')
2025-06-26 14:49:02,286 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,286 - sqlalchemy.engine.Engine - INFO - [cached since 0.05405s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '2010', '9236796', '', 38.06726837158203, -122.53873443603516, None, None, 1, None, 0, None, '2010')
2025-06-26 14:49:02,289 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,289 - sqlalchemy.engine.Engine - INFO - [cached since 0.05704s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '2011', '9237096', '', 37.97056579589844, -122.52255249023438, None, None, 2, None, 0, None, '2011')
2025-06-26 14:49:02,292 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,293 - sqlalchemy.engine.Engine - INFO - [cached since 0.06062s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '2401', '9236696', '', 38.00021743774414, -122.60420227050781, None, None, 1, None, 0, None, '2401')
2025-06-26 14:49:02,295 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,295 - sqlalchemy.engine.Engine - INFO - [cached since 0.06313s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '2402', '9236705', '', 37.952964782714844, -122.4908676147461, None, None, 1, None, 0, None, '2402')
2025-06-26 14:49:02,298 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,298 - sqlalchemy.engine.Engine - INFO - [cached since 0.06574s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '2404', '9236632', '', 37.9649658203125, -122.51388549804688, None, None, 2, None, 0, None, '2404')
2025-06-26 14:49:02,300 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,300 - sqlalchemy.engine.Engine - INFO - [cached since 0.0678s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '2405', '9237097', '', 37.902381896972656, -122.51423645019531, None, None, 2, None, 0, None, '2405')
2025-06-26 14:49:02,302 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,303 - sqlalchemy.engine.Engine - INFO - [cached since 0.07023s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '2406', '9236593', '', 37.99376678466797, -122.53215026855469, None, None, 2, None, 0, None, '2406')
2025-06-26 14:49:02,305 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,305 - sqlalchemy.engine.Engine - INFO - [cached since 0.07289s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '960', '9236955', '150', 37.78708267211914, -122.40081787109375, None, None, 2, None, 1, None, '960')
2025-06-26 14:49:02,308 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,308 - sqlalchemy.engine.Engine - INFO - [cached since 0.07589s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '961', '9236905', '101', 38.220733642578125, -122.607666015625, None, None, 2, None, 1, None, '961')
2025-06-26 14:49:02,310 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,311 - sqlalchemy.engine.Engine - INFO - [cached since 0.07849s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '974', '9236925', '101', 37.79029846191406, -122.39624786376953, None, None, 2, None, 1, None, '974')
2025-06-26 14:49:02,313 - sqlalchemy.engine.Engine - INFO - UPDATE live_vehicle_positions SET timestamp=$1::TIMESTAMP WITHOUT TIME ZONE, vehicle_id=$2::VARCHAR, trip_id=$3::VARCHAR, route_id=$4::VARCHAR, latitude=$5::FLOAT, longitude=$6::FLOAT, bearing=$7::FLOAT, speed=$8::FLOAT, current_status=$9::INTEGER, congestion_level=$10::INTEGER, occupancy_status=$11::INTEGER, stop_id=$12::VARCHAR WHERE live_vehicle_positions.vehicle_id = $13::VARCHAR
2025-06-26 14:49:02,313 - sqlalchemy.engine.Engine - INFO - [cached since 0.08094s ago] (datetime.datetime(2025, 6, 26, 14, 48, 50), '975', '9236487', '172', 37.80723190307617, -122.47509765625, None, None, 1, None, 1, None, '975')
2025-06-26 14:49:02,314 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-06-26 14:49:02,317 - __main__ - INFO - Processed GTFS-RT for GG: 30 vehicles updated, 0 new vehicles added.
2025-06-26 14:49:02,318 - __main__ - INFO - Processing cycle completed in 0.89 seconds.
2025-06-26 14:49:02,318 - __main__ - INFO - Sleeping for 29 seconds...
2025-06-26 14:49:13,890 - __main__ - INFO - GTFS-RT processor stopped by user.
2025-06-26 14:49:13,890 - __main__ - INFO - GTFS-RT processor stopped.
